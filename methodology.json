{"version":2,"kind":"Notebook","sha256":"882244140251b285a2035d70bce5b10f906e375f063dca1d62829825cf982014","slug":"methodology","location":"/methodology.ipynb","dependencies":[],"frontmatter":{"title":"Methodology","content_includes_title":false,"kernelspec":{"name":"python3","display_name":".venv","language":"python"},"authors":[{"nameParsed":{"given":"PolicyEngine","family":"Team","literal":"PolicyEngine Team"},"name":"PolicyEngine Team","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/policyengine/policyengine-uk-data","copyright":"2024","source_url":"https://github.com/policyengine/policyengine-uk-data/blob/main/docs/methodology.ipynb","edit_url":"https://github.com/policyengine/policyengine-uk-data/edit/main/docs/methodology.ipynb","exports":[{"format":"ipynb","filename":"methodology.ipynb","url":"/policyengine-uk-data/build/methodology-281eb0e42a1fa40aaeb559215c5eddde.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this page, we’ll walk through step-by-step the process we use to create PolicyEngine’s dataset.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ClYT32VOPI"}],"key":"BboBmdIzR6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Family Resources Survey","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UIQHDBt1CH"}],"key":"KgPo9P5fWy"},{"type":"text","value":": we’ll start with the FRS, looking at close it is to reality. To take an actual concrete starting point, we’ll assume benefit payments are as reported in the survey.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"QXReO8mlYg"}],"key":"LSSbkuydH9"}],"key":"e0XGU9nvJG"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"FRS (+ tax-benefit model)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Zfh1W4wEzB"}],"key":"iQTu8GNPl9"},{"type":"text","value":": we need to make sure that our tax-benefit model isn’t doing anything unexpected. If we turn on simulation of taxes and benefits, does anything look unexpected? If not- great, we’ve turned a household survey into something useful for policy analysis. We’ll also take stock here of what we’re missing from reality.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FGQeU9pb1a"}],"key":"z2ndeK7LbM"}],"key":"QI0goVpP9d"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Wealth and consumption","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"lACbROTUtk"}],"key":"MBajT8dn4s"},{"type":"text","value":": the most obvious thing we’re missing is wealth and consumption. We’ll impute those here.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QlHRaWFQlh"}],"key":"UhCWNNEj5g"}],"key":"CRlQF0y5eC"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Fine-tuning","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"KwBNlaBRym"}],"key":"Q5INFR8DJ9"},{"type":"text","value":": we’ll use reweighting to make some final adjustments to make sure our dataset is as close to reality as possible.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JtJ61HynlG"}],"key":"QwChuTKKeh"}],"key":"ZtlYjFfwxk"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Validation","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"yZP5BGJ11w"}],"key":"hm0FJUP8c2"},{"type":"text","value":": we’ll compare our dataset to the UK’s official statistics, and see how we’re doing.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"oLq4rKjaMo"}],"key":"lc2WOHvHKm"}],"key":"ekNlXgGvRD"}],"key":"dREbJ8CBtt"},{"type":"heading","depth":2,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"The Family Resources Survey","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"UnBw0HZuXN"}],"identifier":"the-family-resources-survey","label":"The Family Resources Survey","html_id":"the-family-resources-survey","implicit":true,"key":"jMh5yElBov"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"First, we’ll start with the FRS as-is. Skipping over the technical details for how we actually feed this data into the model (you can find that in ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"uQyhQCMpeP"},{"type":"inlineCode","value":"policyengine_uk_data/datasets/frs/","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"fspe6wn2LY"},{"type":"text","value":"), we need to decide how we’re actually going to measure ‘close to reality’. We need to define an objective function, and if our final dataset improves it a lot, we can call that a success.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"jDgL81QVth"}],"key":"apsDj6RYqD"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"We’ll define this objective function using public statistics that we can generally agree are of high importance to describing the UK household sector. These are things that, if the survey gets them wrong, we’d expect to cause inaccuracy in our model, and if we get them all mostly right, we’d expect to have confidence that it’s a pretty accurate tax-benefit model.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"M44FKkPS7a"}],"key":"VeEGPzwkAb"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"For this, we’ve gone through and collected:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"BGu2qQcyIl"}],"key":"o0bHIsNyFd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Demographics","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"J1sLJEk1mo"}],"key":"Fold9Hrf98"},{"type":"text","value":" from the ONS: ten-year age band populations by region of the UK, national family type populations and national tenure type populations.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"krMTtHWNQv"}],"key":"qjtoJZKoPA"}],"key":"FfuqtAL4qC"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Incomes","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"JaA6M79WDy"}],"key":"Ox0NciboYO"},{"type":"text","value":" from HMRC: for each of 14 total income bands, the number of people with income and combined income of the seven income types that account for over 99% of total income: employment, self-employment, State Pension, private pension, property, savings interest, and dividends.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"KQDO7Vw9m2"}],"key":"IjePeZMZB8"}],"key":"l27OcefIjB"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Tax-benefit programs","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"BCxkE1HxWS"}],"key":"q4NjKPSo3R"},{"type":"text","value":" from the DWP and OBR: statistics on caseloads, expenditures and revenues for all 20 major tax-benefit programs.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"qfwrnXy2kI"}],"key":"f6Lp2Nnflr"}],"key":"Oq0SnWo1io"}],"key":"Xa5BD9zdXQ"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Let’s first take a look at the initial FRS, our starting point, and what is generally considered the best dataset to use (mostly completely un-modified across major tax-benefit models), and see how close it is to reproducing these statistics.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"iuPaQARM8u"}],"key":"A0NC5RLuBZ"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"The table below shows the result, and: it’s really quite bad! Look at the relative errors.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"smVx2ZlQhN"}],"key":"kwc1qHc2U6"}],"key":"K4vUydiiC8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from policyengine_uk_data.utils import get_loss_results\nfrom policyengine_uk_data import (\n    FRS_2022_23,\n    ExtendedFRS_2022_23,\n    EnhancedFRS_2022_23,\n    ReweightedFRS_2022_23,\n)\nfrom policyengine_core.model_api import Reform\nimport plotly.express as px\nimport pandas as pd\nfrom itables import init_notebook_mode\nimport itables.options as opt\nopt.maxBytes = \"1MB\"\n\ninit_notebook_mode(all_interactive=True)\n\ndef get_loss(dataset, reform, time_period):\n    loss_results = get_loss_results(dataset, time_period, reform)\n\n    def get_type(name):\n        if \"hmrc\" in name:\n            return \"Income\"\n        if \"ons\" in name:\n            return \"Demographics\"\n        if \"obr\" in name:\n            return \"Tax-benefit\"\n        return \"Other\"\n\n    loss_results[\"type\"] = loss_results.name.apply(get_type)\n    return loss_results\n\nreported_benefits = Reform.from_dict(\n    {\n        \"gov.contrib.policyengine.disable_simulated_benefits\": True,\n    }\n)\nloss_results = get_loss(\n    dataset=FRS_2022_23, reform=reported_benefits, time_period=2025\n).copy()\n\nloss_results","key":"aWMtx0iRjS"},{"type":"output","id":"QK81fSUcMpu5pMVSJQmfo","data":[{"name":"stderr","output_type":"stream","text":"/Users/nikhilwoodruff/policyengine/policyengine-uk-data/.venv/lib/python3.11/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\n  from .autonotebook import tqdm as notebook_tqdm\n"},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<script type=\"module\">\n    const { set_or_remove_dark_class } = await import(window._datatables_src_for_itables_2_4_0);\n    set_or_remove_dark_class();\n</script>\n","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"6644365ef693cda23c0c20fa19d699e4","path":"/policyengine-uk-data/build/6644365ef693cda23c0c20fa19d699e4.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"e42e4d349550591cc96d9f113fa95cff","path":"/policyengine-uk-data/build/e42e4d349550591cc96d9f113fa95cff.html"},"text/plain":{"content":"                                                  name      estimate  \\\n0                             obr/attendance_allowance  3.860683e+09   \n1                                 obr/carers_allowance  2.980367e+09   \n2                                              obr/dla  4.220507e+09   \n3                                              obr/esa  7.454579e+09   \n4                                      obr/esa_contrib  1.838163e+09   \n..                                                 ...           ...   \n341  hmrc/savings_interest_income_count_income_band...  1.511388e+07   \n342  hmrc/dividend_income_income_band_55_12_570.0_t...  9.436481e+09   \n343  hmrc/dividend_income_count_income_band_55_12_5...  2.665563e+06   \n344        dwp/uc_two_child_limit_affected_child_count  1.250681e+06   \n345    dwp/uc_two_child_limit_affected_household_count  3.537498e+05   \n\n           target         error     abs_error  rel_error  abs_rel_error  \\\n0    8.300000e+09 -4.439317e+09  4.439317e+09  -0.534857       0.534857   \n1    4.500000e+09 -1.519633e+09  1.519633e+09  -0.337696       0.337696   \n2    8.000000e+09 -3.779493e+09  3.779493e+09  -0.472437       0.472437   \n3    7.900000e+09 -4.454213e+08  4.454213e+08  -0.056382       0.056382   \n4    5.000000e+09 -3.161837e+09  3.161837e+09  -0.632367       0.632367   \n..            ...           ...           ...        ...            ...   \n341  1.168678e+07  3.427104e+06  3.427104e+06   0.293246       0.293246   \n342  9.838981e+10 -8.895333e+10  8.895333e+10  -0.904091       0.904091   \n343  3.981047e+06 -1.315484e+06  1.315484e+06  -0.330437       0.330437   \n344  1.792000e+06 -5.413195e+05  5.413195e+05  -0.302076       0.302076   \n345  4.928000e+05 -1.390502e+05  1.390502e+05  -0.282163       0.282163   \n\n            type  \n0    Tax-benefit  \n1    Tax-benefit  \n2    Tax-benefit  \n3    Tax-benefit  \n4    Tax-benefit  \n..           ...  \n341       Income  \n342       Income  \n343       Income  \n344        Other  \n345        Other  \n\n[346 rows x 8 columns]","content_type":"text/plain"}}}],"key":"xzBzEgo5b2"}],"key":"WwK4M9JbT6"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It’s easier to understand ‘what kind of bad’ this is by splitting out the statistics into those three categories. Here’s a histogram of the absolute relative errors.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ispssE5s2N"}],"key":"QTWpD1sRYM"}],"key":"jbmp8m3goy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def format_fig(fig):\n    return fig\n\nloss_results.abs_rel_error = loss_results.abs_rel_error.clip(0, 1)\n    \nfig = px.histogram(\n    loss_results,\n    x=\"abs_rel_error\",\n    nbins=25,\n    title=\"Distribution of absolute relative errors\",\n    labels={\n        \"value\": \"Absolute relative error\",\n        \"count\": \"Number of variables\",\n    },\n    color=\"type\",\n    color_discrete_sequence=px.colors.qualitative.T10,\n).update_layout(\n    legend_title=\"Category\",\n    xaxis_title=\"Absolute relative error\",\n    yaxis_title=\"Number of variables\",\n    xaxis_tickformat=\".0%\",)\nformat_fig(fig)","key":"z10xrilOek"},{"type":"output","id":"emxWozkVco1TOV3y-MrGO","data":[{"output_type":"display_data","metadata":{},"data":{"application/vnd.plotly.v1+json":{"content":"{\"config\":{\"plotlyServerURL\":\"https://plot.ly\"},\"data\":[{\"alignmentgroup\":\"True\",\"bingroup\":\"x\",\"hovertemplate\":\"type=Tax-benefit<br>abs_rel_error=%{x}<br>count=%{y}<extra></extra>\",\"legendgroup\":\"Tax-benefit\",\"marker\":{\"color\":\"#4C78A8\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Tax-benefit\",\"nbinsx\":25,\"offsetgroup\":\"Tax-benefit\",\"orientation\":\"v\",\"showlegend\":true,\"type\":\"histogram\",\"x\":[0.5348574279909283,0.33769630678188683,0.4724366479253982,0.056382436859752076,0.6323673982942971,0.9366950828549806,0.11071012537714943,0.43224912766430945,0.4932054498037529,0.4262926636695862,0.17368378985595703,0.33892402775691105,0.06411683428955078,0.31529940174102783,0.2753207784816197,0.2723132074858013,0.8419023088645935,0.38591469862268324,1,1,0.238984410722884,0.05022357544387739,0.021321091676393004,0.4372354547058456,0.07523280073668749,0.6813040233247071,1,0.09093881776916021,0.7953899467026746,0.46345942912091304,1,0.2891328586136087,0.016902187542991637,0.5771045241320162,0.8632298833420071,0.5055628005622791,1,1,0.1204769296971429],\"xaxis\":\"x\",\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"bingroup\":\"x\",\"hovertemplate\":\"type=Demographics<br>abs_rel_error=%{x}<br>count=%{y}<extra></extra>\",\"legendgroup\":\"Demographics\",\"marker\":{\"color\":\"#F58518\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Demographics\",\"nbinsx\":25,\"offsetgroup\":\"Demographics\",\"orientation\":\"v\",\"showlegend\":true,\"type\":\"histogram\",\"x\":[0.18636310943363776,0.15146912469328816,0.10932430429485258,0.10231019438643418,0.07556825835482431,0.145946911654333,0.07105392754690722,0.056645307043117855,0.04613438039833396,0.17900131626571955,0.10437807305849049,0.04133579034001572,0.01689458524887367,0.07304306223253616,0.1466605180751631,0.07986269998663076,0.06725714841222848,0.02570792373305158,0.2117702613060218,0.06261644764053753,0.11048854967581091,0.05986189620431352,0.0734813370478334,0.14993575315772975,0.09216128695626061,0.06654101281860526,0.030242342070154266,0.20055057386109623,0.09490778457907527,0.15890381361993214,0.09147390139813617,0.07256124815551596,0.14006199032920222,0.06918929372173468,0.0641021816680276,0.02739238584286876,0.17692221807058495,0.1465247819963169,0.0737355589323719,0.06948184222007073,0.08120377680970711,0.14771312168786133,0.09192541367318888,0.05198270343522084,0.02894483338415261,0.19421519077802243,0.10227911889430563,0.022966625631099497,0.04223796065100079,0.07170636880139063,0.14546833526385414,0.10891147656435791,0.04531287298102462,0.012215875566847865,0.29116400964006,0.12510157647671732,0.04460071124716505,0.13148586282369953,0.12155024410317292,0.1461505005795304,0.09404538078799742,0.15711451997858814,0.07684637616907224,0.1739255359932635,0.06968768763060447,0.048645930535396516,0.04715293440571787,0.061179568577858875,0.14599437481067512,0.07423160697853332,0.08014078307669949,0.04069199366965248,0.18721575205594373,0.14720678189147138,0.021828844225395293,0.0625035269825679,0.06472770792630214,0.14068027648917297,0.06569813195335417,0.065331238772402,0.03383163643088508,0.2078691963062574,0.15441863025620098,0.10737865871453003,0.09454279295816925,0.09633845930037417,0.15611969585317312,0.06873017587493258,0.0791181851399526,0.025598437037858832,0.16656003316208637,0.1384734213448285,0.06731946150876865,0.14050146457241625,0.08162092155759072,0.11667759541165895,0.030289924549114444,0.06339486495990165,0.05731838222169315,0.18678826188260914,0.13891870679655027,0.11545889612594176,0.09001345414783932,0.08098886341630986,0.14588527398461482,0.07287641126080605,0.024770034717212553,0.0684751962412611,0.01245076401040619],\"xaxis\":\"x\",\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"bingroup\":\"x\",\"hovertemplate\":\"type=Income<br>abs_rel_error=%{x}<br>count=%{y}<extra></extra>\",\"legendgroup\":\"Income\",\"marker\":{\"color\":\"#E45756\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Income\",\"nbinsx\":25,\"offsetgroup\":\"Income\",\"orientation\":\"v\",\"showlegend\":true,\"type\":\"histogram\",\"x\":[1,1,1,1,1,1,1,1,0.8530274371209137,1,1,1,1,1,0.19149475966528307,0.24673403495070823,0.3072794892096273,0.379747974710697,0.31039305362432584,0.10848112754405202,0.010619302099698998,0.13888253105203519,0.4073900806470958,0.2531205286437236,0.792085840046357,0.006433659456298493,0.5934162832292477,0.008940409722294219,0.04335675878207915,0.05017349529511451,0.03973531361317136,0.2350261871873867,0.4310117757696614,0.24612705047281858,0.12926913086657413,0.21946877869613568,0.5242635218702594,0.35286947713846034,0.43478116250659926,0.03957663112558911,0.7638985610220846,0.41669987859417645,0.06992062037206717,0.038954754430174716,0.1702228614236586,0.3644700400430666,0.40331728828616015,0.18229923682794535,0.048977526847925265,0.14516341715331396,0.4225749995583743,0.25472950837045066,1,0.3201977607447135,0.8908866821198612,0.3647842083382897,0.054489850288550065,0.12854107496184566,0.11753069172373803,0.11321576973743849,0.34453613181731424,0.1244811487104074,0.06072357901250304,0.12789286633886923,0.4588320425543538,0.23863636631820653,0.5474622628827415,0.30226424119880596,0.8856712808994389,0.4473604762734464,0.11850271000359837,0.003773473791717633,0.5013148425482626,0.032331919418836653,0.3379801252340519,0.1101123244337878,0.002039042612175903,0.10686992109637393,0.529566917828135,0.364533754611501,0.8714741500070979,0.3758462425849252,0.9160445175597087,0.4321594002439528,0.06604500940315498,0.03876573963794215,0.9211680206617687,0.22674879162547168,0.3174237803524217,0.10323686418719458,0.02833021844744379,0.002564206987639185,0.5289418217741038,0.3200630182858172,1,0.5029385157743501,0.8471689821257619,0.21622933403097414,0.1315637600363954,0.014207504312205523,1,0.43231937365869,0.17936817815314637,0.09069845844777394,0.21653261782151073,0.10904328492252735,0.45696603359696897,0.10027631605492449,0.14383375266562679,0.7256394043973807,0.8423948571490725,0.2589492388346111,0.2353889384491187,0.14548208834407161,0.9851234327091203,0.3397268942949406,0.39379184896953845,0.0786704963046369,0.09609641144440331,0.0074050587750516175,0.6175878341381192,0.2383574886847478,0.08836760498290175,1,0.8359068830577554,0.2627782706474406,0.14986446226951086,0.02516240308487657,0.6332805209567846,0.14800488620689517,0.500674061334277,0.017031235583756046,0.6740757152767093,0.28536782505453023,0.7449323132373478,0.273695744109254,0.10090010598312445,0.5747793559128609,0.9107437140452885,0.34401959095740303,1,1,1,1,0.8684502342014089,0.7344750160682946,0.8686393732736275,0.43612221537997764,0.6769238453303257,0.20200886652112943,0.0266550847359111,1,0.9111351285678312,0.23475475001971127,0.987640762587488,0.9835036985633404,0.14278799841519346,0.22361630855449383,0.9296698695284026,0.827944905065973,0.9949206266575741,0.8286463118940774,0.7054238995836947,0.6591252642520408,0.5467248472067474,0.7483442097289045,0.9789237514645788,0.7658415543956806,0.9979477775731906,0.9599693030243193,0.8309056529775222,0.7063448234599843,0.025177568881478127,0.3592588544667672,1,1,0.9926826451871978,0.9128835701758315,0.9947484624313153,0.8693660641248387,1,1,0.035836087718205054,0.03891346894228955,0.13385158796068683,0.12169435256029607,0.2836104416464377,0.05094982968902384,0.034294312830338104,0.05800330159325003,0.508899022741769,0.257589360854839,0.6548370775766441,0.2932462480888995,0.9040908751204909,0.33043668625756617],\"xaxis\":\"x\",\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"bingroup\":\"x\",\"hovertemplate\":\"type=Other<br>abs_rel_error=%{x}<br>count=%{y}<extra></extra>\",\"legendgroup\":\"Other\",\"marker\":{\"color\":\"#72B7B2\",\"pattern\":{\"shape\":\"\"}},\"name\":\"Other\",\"nbinsx\":25,\"offsetgroup\":\"Other\",\"orientation\":\"v\",\"showlegend\":true,\"type\":\"histogram\",\"x\":[0.30207558611461105,0.2821634970702135],\"xaxis\":\"x\",\"yaxis\":\"y\"}],\"layout\":{\"barmode\":\"relative\",\"legend\":{\"title\":{\"text\":\"Category\"},\"tracegroupgap\":0},\"template\":{\"data\":{\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"contour\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"heatmap\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"sequentialminus\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"geo\":{\"bgcolor\":\"white\",\"lakecolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"white\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"bgcolor\":\"#E5ECF6\",\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"bgcolor\":\"#E5ECF6\",\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"zerolinewidth\":2}}},\"title\":{\"text\":\"Distribution of absolute relative errors\"},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0,1],\"tickformat\":\".0%\",\"title\":{\"text\":\"Absolute relative error\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0,1],\"title\":{\"text\":\"Number of variables\"}}}}","content_type":"application/vnd.plotly.v1+json"}}}],"key":"YwgPp3uva9"}],"key":"qgbJC8BXbp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A few notes:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QdJuyfqn0X"}],"key":"c0zgt0FQrs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We’re comparing things in the same relevant time period (2022), and only doing a tiny amount of adjustment to the statistics: OBR statistics are taken directly from the latest EFO, ONS statistics are the most recent projections for 2022, and HMRC statistics are uprated from 2021 to 2022 using the same standard uprating factors we use in the model (and it’s only one year adjustment).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BlOSFYoe82"}],"key":"LjnL4AFm2L"}],"key":"sHguVMI69Z"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Demogaphics look basically fine: that’s expected, because the DWP applies an optimisation algorithm to optimise the household weights to be as close as possible to a similar set of demographic statistics. It’s a good sign that we use slightly different statistics than it was trained on and get good accuracy.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"s9S7RpIwOl"}],"key":"ifbPKDIj48"}],"key":"KXmxr7WP07"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Incomes look ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yjjnIeeqpn"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"not great at all","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gn24C86KT9"}],"key":"OfRPPQdACg"},{"type":"text","value":". We’ll take a closer look below to understand why. But the FRS is well-known to under-report income significantly.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"F8vvVUFTPQ"}],"key":"ojOG3jLKy1"}],"key":"PR8gUpwLai"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Tax-benefit programs also look ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jYEB6U8Dog"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"not good","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"U5w975xMtg"}],"key":"jFtzNkqQHn"},{"type":"text","value":". And this is a concern! Because we’re using this dataset to answer questions about tax-benefit programs, and the FRS isn’t even providing a good representation of them under baseline law.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"uNRGnu5rI8"}],"key":"BbDJNcX56O"}],"key":"zBnhvzbJ0n"}],"key":"isv9a2Ic8E"}],"key":"pRvLAAFsv6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"incomes = loss_results[loss_results.type == \"Income\"]\nincomes[\"band\"] = incomes.name.apply(\n    lambda x: \"_\".join(x.split(\"band_\")[1].split(\"_\")[1:])\n)\nincomes[\"count\"] = incomes.name.apply(lambda x: \"count\" in x)\nincomes[\"variable\"] = incomes.name.apply(\n    lambda x: x.split(\"_income_band\")[0].split(\"_count\")[0].split(\"hmrc/\")[-1]\n)\n\nvariable = \"employment_income\"\ncount = True\nvariable_df = incomes[\n    (incomes.variable == variable) & (incomes[\"count\"] == count)\n]\n\nfig = px.bar(\n    variable_df,\n    x=\"band\",\n    y=[\n        \"target\",\n        \"estimate\",\n        \"error\",\n        \"rel_error\",\n        \"abs_error\",\n        \"abs_rel_error\",\n    ],\n    barmode=\"group\",\n    color_discrete_sequence=px.colors.qualitative.T10,\n)\n\nfig = fig.update_layout(\n    title=\"Estimates and ground truth for employment income band counts\",\n    xaxis_title=\"\",\n    yaxis_title=\"Value\",\n    legend_title=\"Variable\",\n)\nformat_fig(fig)","key":"RAHDOt3AV7"},{"type":"output","id":"tpZW-Bu7tPJVqtmAjPPi8","data":[{"output_type":"display_data","metadata":{},"data":{"application/vnd.plotly.v1+json":{"content":"{\"config\":{\"plotlyServerURL\":\"https://plot.ly\"},\"data\":[{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=target<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"target\",\"marker\":{\"color\":\"#4C78A8\",\"pattern\":{\"shape\":\"\"}},\"name\":\"target\",\"offsetgroup\":\"target\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[397648,2455344,6725705,5647922,3934646,3671529,1899912,979383,273418,199891,106487,51274,26864,26370022],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=estimate<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"estimate\",\"marker\":{\"color\":\"#F58518\",\"pattern\":{\"shape\":\"\"}},\"name\":\"estimate\",\"offsetgroup\":\"estimate\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[1033786.8507080078,1849527.0676879883,6388252.871826172,5427908.585449219,3428882.373565674,3657674.5815429688,1826260.506072998,993297.5881958008,313195.4216308594,204920.73791503906,218245.16729736328,845.8313598632812,1075.3846435546875,25343872.967895508],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"error\",\"marker\":{\"color\":\"#E45756\",\"pattern\":{\"shape\":\"\"}},\"name\":\"error\",\"offsetgroup\":\"error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[636138.8507080078,-605816.9323120117,-337452.1281738281,-220013.41455078125,-505763.6264343262,-13854.41845703125,-73651.49392700195,13914.588195800781,39777.421630859375,5029.7379150390625,111758.16729736328,-50428.16864013672,-25788.615356445312,-1026149.0321044922],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=rel_error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"rel_error\",\"marker\":{\"color\":\"#72B7B2\",\"pattern\":{\"shape\":\"\"}},\"name\":\"rel_error\",\"offsetgroup\":\"rel_error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[1.5997536783990056,-0.24673403495070823,-0.05017349529511451,-0.038954754430174716,-0.12854107496184566,-0.003773473791717633,-0.03876573963794215,0.014207504312205523,0.14548208834407161,0.02516240308487657,1.0495005709369527,-0.9835036985633404,-0.9599693030243193,-0.03891346894228955],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=abs_error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"abs_error\",\"marker\":{\"color\":\"#54A24B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"abs_error\",\"offsetgroup\":\"abs_error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[636138.8507080078,605816.9323120117,337452.1281738281,220013.41455078125,505763.6264343262,13854.41845703125,73651.49392700195,13914.588195800781,39777.421630859375,5029.7379150390625,111758.16729736328,50428.16864013672,25788.615356445312,1026149.0321044922],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=abs_rel_error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"abs_rel_error\",\"marker\":{\"color\":\"#EECA3B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"abs_rel_error\",\"offsetgroup\":\"abs_rel_error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[1.5997536783990056,0.24673403495070823,0.05017349529511451,0.038954754430174716,0.12854107496184566,0.003773473791717633,0.03876573963794215,0.014207504312205523,0.14548208834407161,0.02516240308487657,1.0495005709369527,0.9835036985633404,0.9599693030243193,0.03891346894228955],\"yaxis\":\"y\"}],\"layout\":{\"barmode\":\"group\",\"legend\":{\"title\":{\"text\":\"Variable\"},\"tracegroupgap\":0},\"margin\":{\"t\":60},\"template\":{\"data\":{\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"contour\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"heatmap\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"sequentialminus\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"geo\":{\"bgcolor\":\"white\",\"lakecolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"white\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"bgcolor\":\"#E5ECF6\",\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"bgcolor\":\"#E5ECF6\",\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"zerolinewidth\":2}}},\"title\":{\"text\":\"Estimates and ground truth for employment income band counts\"},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0,1],\"title\":{\"text\":\"\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0,1],\"title\":{\"text\":\"Value\"}}}}","content_type":"application/vnd.plotly.v1+json"}}}],"key":"NdpE4cGyj9"}],"key":"BgH1Mrl3R8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"variable = \"dividend_income\"\ncount = True\nvariable_df = incomes[\n    (incomes.variable == variable) & (incomes[\"count\"] == count)\n]\n\nfig = px.bar(\n    variable_df,\n    x=\"band\",\n    y=[\n        \"target\",\n        \"estimate\",\n        \"error\",\n        \"rel_error\",\n        \"abs_error\",\n        \"abs_rel_error\",\n    ],\n    barmode=\"group\",\n    color_discrete_sequence=px.colors.qualitative.T10,\n)\n\nfig = fig.update_layout(\n    title=\"Estimates and ground truth for dividend income band counts\",\n    xaxis_title=\"\",\n    yaxis_title=\"Value\",\n    legend_title=\"Variable\",\n)\nformat_fig(fig)","key":"Ij5OL5bf51"},{"type":"output","id":"tZpuIpJVc0hBBLe1zFDKC","data":[{"output_type":"display_data","metadata":{},"data":{"application/vnd.plotly.v1+json":{"content":"{\"config\":{\"plotlyServerURL\":\"https://plot.ly\"},\"data\":[{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=target<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"target\",\"marker\":{\"color\":\"#4C78A8\",\"pattern\":{\"shape\":\"\"}},\"name\":\"target\",\"offsetgroup\":\"target\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[20214,262236,745073,669779,582376,806153,360245,250211,98364,82376,49147,34241,20632,3981047],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=estimate<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"estimate\",\"marker\":{\"color\":\"#F58518\",\"pattern\":{\"shape\":\"\"}},\"name\":\"estimate\",\"offsetgroup\":\"estimate\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[126056.78784179688,259891.50271606445,434601.1713562012,425454.1977233887,321843.9952697754,457766.4030151367,282349.4635620117,185419.05200195312,72516.07818603516,54037.04217529297,37609.50830078125,8017.8193359375,0,2665563.021484375],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"error\",\"marker\":{\"color\":\"#E45756\",\"pattern\":{\"shape\":\"\"}},\"name\":\"error\",\"offsetgroup\":\"error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[105842.78784179688,-2344.497283935547,-310471.8286437988,-244324.80227661133,-260532.0047302246,-348386.5969848633,-77895.53643798828,-64791.947998046875,-25847.921813964844,-28338.95782470703,-11537.49169921875,-26223.1806640625,-20632,-1315483.978515625],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=rel_error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"rel_error\",\"marker\":{\"color\":\"#72B7B2\",\"pattern\":{\"shape\":\"\"}},\"name\":\"rel_error\",\"offsetgroup\":\"rel_error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[5.236112983169925,-0.008940409722294219,-0.41669987859417645,-0.3647842083382897,-0.4473604762734464,-0.4321594002439528,-0.21622933403097414,-0.2589492388346111,-0.2627782706474406,-0.34401959095740303,-0.23475475001971127,-0.7658415543956806,-1,-0.33043668625756617],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=abs_error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"abs_error\",\"marker\":{\"color\":\"#54A24B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"abs_error\",\"offsetgroup\":\"abs_error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[105842.78784179688,2344.497283935547,310471.8286437988,244324.80227661133,260532.0047302246,348386.5969848633,77895.53643798828,64791.947998046875,25847.921813964844,28338.95782470703,11537.49169921875,26223.1806640625,20632,1315483.978515625],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=abs_rel_error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"abs_rel_error\",\"marker\":{\"color\":\"#EECA3B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"abs_rel_error\",\"offsetgroup\":\"abs_rel_error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[5.236112983169925,0.008940409722294219,0.41669987859417645,0.3647842083382897,0.4473604762734464,0.4321594002439528,0.21622933403097414,0.2589492388346111,0.2627782706474406,0.34401959095740303,0.23475475001971127,0.7658415543956806,1,0.33043668625756617],\"yaxis\":\"y\"}],\"layout\":{\"barmode\":\"group\",\"legend\":{\"title\":{\"text\":\"Variable\"},\"tracegroupgap\":0},\"margin\":{\"t\":60},\"template\":{\"data\":{\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"contour\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"heatmap\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"sequentialminus\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"geo\":{\"bgcolor\":\"white\",\"lakecolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"white\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"bgcolor\":\"#E5ECF6\",\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"bgcolor\":\"#E5ECF6\",\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"zerolinewidth\":2}}},\"title\":{\"text\":\"Estimates and ground truth for dividend income band counts\"},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0,1],\"title\":{\"text\":\"\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0,1],\"title\":{\"text\":\"Value\"}}}}","content_type":"application/vnd.plotly.v1+json"}}}],"key":"av6sJU5R3J"}],"key":"QnX275jfNZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"There are a few interesting things here:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O62IWRkOJD"}],"key":"M0KfSxgRfn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The FRS over-estimates incomes in the upper-middle of the distribution and under-estimates them in the top of the distribution. The reason for this is probably: the FRS misses out the top completely, and then because of the weight optimisation (which scales up the working-age age groups to hit their population targets), the middle of the distribution is inflated, overcompensating.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vA9CaI3bxZ"}],"key":"VCDRisJmwN"}],"key":"JAn7wXErEK"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Some income types are severely under-estimated across all bands: notably capital incomes. This probably reflects issues with the survey questionnaire design more than sampling bias.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XtSt9VduVn"}],"key":"l19jVx2Ezi"}],"key":"MsjVqRPsEc"}],"key":"e0Vv2x6s3K"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"OK, so what can we do about it?","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ZDy07QyKce"}],"key":"QrPzErtnDa"},{"type":"heading","depth":2,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Simulating benefits","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"AJXWsg7zqQ"}],"identifier":"simulating-benefits","label":"Simulating benefits","html_id":"simulating-benefits","implicit":true,"key":"PX0VTGxkHO"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"First, let’s turn on the model and check nothing unexpected happens. The table below shows each of our known statistics, and how they changed after replacing reported benefits with simulated benefits.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"WQui3nF007"}],"key":"rI8Ou2cOlU"}],"key":"J3JgJKDoTW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"original_frs_loss = loss_results.copy()\nfrs_loss = get_loss(FRS_2022_23, None, 2025).copy()\ncombined_frs_loss = pd.merge(\n    on=\"name\",\n    left=original_frs_loss,\n    right=frs_loss,\n    suffixes=(\"_original\", \"_simulated\"),\n)\ncombined_frs_loss[\"change_in_abs_rel_error\"] = (\n    combined_frs_loss[\"abs_rel_error_simulated\"]\n    - combined_frs_loss[\"abs_rel_error_original\"]\n)\n# Sort columns\ncombined_frs_loss.sort_index(axis=1, inplace=True)\ncombined_frs_loss = combined_frs_loss.set_index(\"name\")\n\ncombined_frs_loss","key":"WjXTDNAwit"},{"type":"output","id":"lgL5-zPBvgPXnc4sM4K5k","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"53b8359dda5b06744ccc1f859b211c7a","path":"/policyengine-uk-data/build/53b8359dda5b06744ccc1f859b211c7a.html"},"text/plain":{"content":"                                                    abs_error_original  \\\nname                                                                     \nobr/attendance_allowance                                  4.439317e+09   \nobr/carers_allowance                                      1.519633e+09   \nobr/dla                                                   3.779493e+09   \nobr/esa                                                   4.454213e+08   \nobr/esa_contrib                                           3.161837e+09   \n...                                                                ...   \nhmrc/savings_interest_income_count_income_band_...        3.427104e+06   \nhmrc/dividend_income_income_band_55_12_570.0_to...        8.895333e+10   \nhmrc/dividend_income_count_income_band_55_12_57...        1.315484e+06   \ndwp/uc_two_child_limit_affected_child_count               5.413195e+05   \ndwp/uc_two_child_limit_affected_household_count           1.390502e+05   \n\n                                                    abs_error_simulated  \\\nname                                                                      \nobr/attendance_allowance                                   3.687392e+09   \nobr/carers_allowance                                       9.211583e+08   \nobr/dla                                                    3.045346e+09   \nobr/esa                                                    4.161031e+08   \nobr/esa_contrib                                            2.949401e+09   \n...                                                                 ...   \nhmrc/savings_interest_income_count_income_band_...         3.745061e+06   \nhmrc/dividend_income_income_band_55_12_570.0_to...         8.891662e+10   \nhmrc/dividend_income_count_income_band_55_12_57...         1.268499e+06   \ndwp/uc_two_child_limit_affected_child_count                4.034872e+05   \ndwp/uc_two_child_limit_affected_household_count            9.765821e+04   \n\n                                                    abs_rel_error_original  \\\nname                                                                         \nobr/attendance_allowance                                          0.534857   \nobr/carers_allowance                                              0.337696   \nobr/dla                                                           0.472437   \nobr/esa                                                           0.056382   \nobr/esa_contrib                                                   0.632367   \n...                                                                    ...   \nhmrc/savings_interest_income_count_income_band_...                0.293246   \nhmrc/dividend_income_income_band_55_12_570.0_to...                0.904091   \nhmrc/dividend_income_count_income_band_55_12_57...                0.330437   \ndwp/uc_two_child_limit_affected_child_count                       0.302076   \ndwp/uc_two_child_limit_affected_household_count                   0.282163   \n\n                                                    abs_rel_error_simulated  \\\nname                                                                          \nobr/attendance_allowance                                           0.444264   \nobr/carers_allowance                                               0.204702   \nobr/dla                                                            0.380668   \nobr/esa                                                            0.052671   \nobr/esa_contrib                                                    0.589880   \n...                                                                     ...   \nhmrc/savings_interest_income_count_income_band_...                 0.320453   \nhmrc/dividend_income_income_band_55_12_570.0_to...                 0.903718   \nhmrc/dividend_income_count_income_band_55_12_57...                 0.318635   \ndwp/uc_two_child_limit_affected_child_count                        0.225160   \ndwp/uc_two_child_limit_affected_household_count                    0.198170   \n\n                                                    change_in_abs_rel_error  \\\nname                                                                          \nobr/attendance_allowance                                          -0.090593   \nobr/carers_allowance                                              -0.132994   \nobr/dla                                                           -0.091768   \nobr/esa                                                           -0.003711   \nobr/esa_contrib                                                   -0.042487   \n...                                                                     ...   \nhmrc/savings_interest_income_count_income_band_...                 0.027207   \nhmrc/dividend_income_income_band_55_12_570.0_to...                -0.000373   \nhmrc/dividend_income_count_income_band_55_12_57...                -0.011802   \ndwp/uc_two_child_limit_affected_child_count                       -0.076915   \ndwp/uc_two_child_limit_affected_household_count                   -0.083993   \n\n                                                    error_original  \\\nname                                                                 \nobr/attendance_allowance                             -4.439317e+09   \nobr/carers_allowance                                 -1.519633e+09   \nobr/dla                                              -3.779493e+09   \nobr/esa                                              -4.454213e+08   \nobr/esa_contrib                                      -3.161837e+09   \n...                                                            ...   \nhmrc/savings_interest_income_count_income_band_...    3.427104e+06   \nhmrc/dividend_income_income_band_55_12_570.0_to...   -8.895333e+10   \nhmrc/dividend_income_count_income_band_55_12_57...   -1.315484e+06   \ndwp/uc_two_child_limit_affected_child_count          -5.413195e+05   \ndwp/uc_two_child_limit_affected_household_count      -1.390502e+05   \n\n                                                    error_simulated  \\\nname                                                                  \nobr/attendance_allowance                              -3.687392e+09   \nobr/carers_allowance                                  -9.211583e+08   \nobr/dla                                               -3.045346e+09   \nobr/esa                                                4.161031e+08   \nobr/esa_contrib                                       -2.949401e+09   \n...                                                             ...   \nhmrc/savings_interest_income_count_income_band_...     3.745061e+06   \nhmrc/dividend_income_income_band_55_12_570.0_to...    -8.891662e+10   \nhmrc/dividend_income_count_income_band_55_12_57...    -1.268499e+06   \ndwp/uc_two_child_limit_affected_child_count           -4.034872e+05   \ndwp/uc_two_child_limit_affected_household_count       -9.765821e+04   \n\n                                                    estimate_original  \\\nname                                                                    \nobr/attendance_allowance                                 3.860683e+09   \nobr/carers_allowance                                     2.980367e+09   \nobr/dla                                                  4.220507e+09   \nobr/esa                                                  7.454579e+09   \nobr/esa_contrib                                          1.838163e+09   \n...                                                               ...   \nhmrc/savings_interest_income_count_income_band_...       1.511388e+07   \nhmrc/dividend_income_income_band_55_12_570.0_to...       9.436481e+09   \nhmrc/dividend_income_count_income_band_55_12_57...       2.665563e+06   \ndwp/uc_two_child_limit_affected_child_count              1.250681e+06   \ndwp/uc_two_child_limit_affected_household_count          3.537498e+05   \n\n                                                    estimate_simulated  \\\nname                                                                     \nobr/attendance_allowance                                  4.612608e+09   \nobr/carers_allowance                                      3.578842e+09   \nobr/dla                                                   4.954654e+09   \nobr/esa                                                   8.316103e+09   \nobr/esa_contrib                                           2.050599e+09   \n...                                                                ...   \nhmrc/savings_interest_income_count_income_band_...        1.543184e+07   \nhmrc/dividend_income_income_band_55_12_570.0_to...        9.473187e+09   \nhmrc/dividend_income_count_income_band_55_12_57...        2.712548e+06   \ndwp/uc_two_child_limit_affected_child_count               1.388513e+06   \ndwp/uc_two_child_limit_affected_household_count           3.951418e+05   \n\n                                                    rel_error_original  \\\nname                                                                     \nobr/attendance_allowance                                     -0.534857   \nobr/carers_allowance                                         -0.337696   \nobr/dla                                                      -0.472437   \nobr/esa                                                      -0.056382   \nobr/esa_contrib                                              -0.632367   \n...                                                                ...   \nhmrc/savings_interest_income_count_income_band_...            0.293246   \nhmrc/dividend_income_income_band_55_12_570.0_to...           -0.904091   \nhmrc/dividend_income_count_income_band_55_12_57...           -0.330437   \ndwp/uc_two_child_limit_affected_child_count                  -0.302076   \ndwp/uc_two_child_limit_affected_household_count              -0.282163   \n\n                                                    rel_error_simulated  \\\nname                                                                      \nobr/attendance_allowance                                      -0.444264   \nobr/carers_allowance                                          -0.204702   \nobr/dla                                                       -0.380668   \nobr/esa                                                        0.052671   \nobr/esa_contrib                                               -0.589880   \n...                                                                 ...   \nhmrc/savings_interest_income_count_income_band_...             0.320453   \nhmrc/dividend_income_income_band_55_12_570.0_to...            -0.903718   \nhmrc/dividend_income_count_income_band_55_12_57...            -0.318635   \ndwp/uc_two_child_limit_affected_child_count                   -0.225160   \ndwp/uc_two_child_limit_affected_household_count               -0.198170   \n\n                                                    target_original  \\\nname                                                                  \nobr/attendance_allowance                               8.300000e+09   \nobr/carers_allowance                                   4.500000e+09   \nobr/dla                                                8.000000e+09   \nobr/esa                                                7.900000e+09   \nobr/esa_contrib                                        5.000000e+09   \n...                                                             ...   \nhmrc/savings_interest_income_count_income_band_...     1.168678e+07   \nhmrc/dividend_income_income_band_55_12_570.0_to...     9.838981e+10   \nhmrc/dividend_income_count_income_band_55_12_57...     3.981047e+06   \ndwp/uc_two_child_limit_affected_child_count            1.792000e+06   \ndwp/uc_two_child_limit_affected_household_count        4.928000e+05   \n\n                                                    target_simulated  \\\nname                                                                   \nobr/attendance_allowance                                8.300000e+09   \nobr/carers_allowance                                    4.500000e+09   \nobr/dla                                                 8.000000e+09   \nobr/esa                                                 7.900000e+09   \nobr/esa_contrib                                         5.000000e+09   \n...                                                              ...   \nhmrc/savings_interest_income_count_income_band_...      1.168678e+07   \nhmrc/dividend_income_income_band_55_12_570.0_to...      9.838981e+10   \nhmrc/dividend_income_count_income_band_55_12_57...      3.981047e+06   \ndwp/uc_two_child_limit_affected_child_count             1.792000e+06   \ndwp/uc_two_child_limit_affected_household_count         4.928000e+05   \n\n                                                   type_original  \\\nname                                                               \nobr/attendance_allowance                             Tax-benefit   \nobr/carers_allowance                                 Tax-benefit   \nobr/dla                                              Tax-benefit   \nobr/esa                                              Tax-benefit   \nobr/esa_contrib                                      Tax-benefit   \n...                                                          ...   \nhmrc/savings_interest_income_count_income_band_...        Income   \nhmrc/dividend_income_income_band_55_12_570.0_to...        Income   \nhmrc/dividend_income_count_income_band_55_12_57...        Income   \ndwp/uc_two_child_limit_affected_child_count                Other   \ndwp/uc_two_child_limit_affected_household_count            Other   \n\n                                                   type_simulated  \nname                                                               \nobr/attendance_allowance                              Tax-benefit  \nobr/carers_allowance                                  Tax-benefit  \nobr/dla                                               Tax-benefit  \nobr/esa                                               Tax-benefit  \nobr/esa_contrib                                       Tax-benefit  \n...                                                           ...  \nhmrc/savings_interest_income_count_income_band_...         Income  \nhmrc/dividend_income_income_band_55_12_570.0_to...         Income  \nhmrc/dividend_income_count_income_band_55_12_57...         Income  \ndwp/uc_two_child_limit_affected_child_count                 Other  \ndwp/uc_two_child_limit_affected_household_count             Other  \n\n[346 rows x 15 columns]","content_type":"text/plain"}}}],"key":"mxGgnpx7uc"}],"key":"iiFgbYigHA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Again, a few notes:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VfxiFX2QyY"}],"key":"WPVQeuBC4M"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"You might be thinking: ‘why do some of the HMRC income statistics change?’. That’s because of the State Pension, which is simulated in the model. The State Pension is a component of total income, so people might be moved from one income band to another if we adjust their State Pension payments slightly.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AFv4aYHPWi"}],"key":"qO3XMDgcEj"}],"key":"RoQwKVXkua"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Some of the tax-benefit statistics change, and get better and worse. This is expected for a variety of reasons- one is that incomes and benefits are often out of sync with each other in the data (the income in the survey week might not match income in the benefits assessment time period).","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"I07z9of5Ow"}],"key":"AN8tdiSo2D"}],"key":"vBtlueLV1q"}],"key":"jGheiHO8rg"},{"type":"heading","depth":2,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Adding imputations","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"alXBaWfVC4"}],"identifier":"adding-imputations","label":"Adding imputations","html_id":"adding-imputations","implicit":true,"key":"fCMuLPIKMH"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Now, let’s add in the imputations for wealth and consumption. For this, we train ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"tjljBEhz5u"},{"type":"emphasis","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"quantile regression forests","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"A6oa2V9YbW"}],"key":"Q9vmsfIw3o"},{"type":"text","value":" (essentially, random forest models that capture the conditional distribution of the data) to predict wealth and consumption variables from FRS-shared variables in other surveys.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"CTX8owEK2z"}],"key":"hSlBIKRRGb"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"The datasets we use are:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"cGHnMXy8SE"}],"key":"XW6f6yROX7"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The Wealth and Assets Survey (WAS) for wealth imputations.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"cQH5dhbGfK"}],"key":"RZoa70wcVg"}],"key":"y9Fn2I5QsD"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The Living Costs and Food Survey (LCFS) for most consumption imputations.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"YvGUUrhgHf"}],"key":"T3LUSMGQmY"}],"key":"NcJZSTqJSK"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The Effects of Taxes and Benefits on Household Income (ETB) for ‘£ consumption that is full VAT rateable’. For example, different households will have different profiles in terms of the share of their consumption that falls on the VATable items.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"AGm0yLl6va"}],"key":"vFeCInj3gi"}],"key":"o5Rgo8aGvb"}],"key":"pLcDJ6AWOK"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Below is a table showing how just adding these imputations changes our objective statistics (filtered to just rows which changed). Not bad pre-calibrated performance! And we’ve picked up an extra £200bn in taxes.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"yvN1wUcJjn"}],"key":"ododOtBCh4"}],"key":"CiO36MKKhZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"new_loss = get_loss(ExtendedFRS_2022_23, None, 2025).copy()\nnew_loss_against_old = pd.merge(\n    on=\"name\",\n    left=frs_loss,\n    right=new_loss,\n    suffixes=(\"_simulated\", \"_imputed\"),\n)\nnew_loss_against_old[\"change_in_abs_rel_error\"] = (\n    new_loss_against_old[\"abs_rel_error_imputed\"]\n    - new_loss_against_old[\"abs_rel_error_simulated\"]\n)\n\nnew_loss_against_old","key":"EzLdAj1RCG"},{"type":"output","id":"Rt69Wx-3dQEPobxAngrhn","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"5728df02027709c7fa39a47293541be6","path":"/policyengine-uk-data/build/5728df02027709c7fa39a47293541be6.html"},"text/plain":{"content":"                                                  name  estimate_simulated  \\\n0                             obr/attendance_allowance        4.612608e+09   \n1                                 obr/carers_allowance        3.578842e+09   \n2                                              obr/dla        4.954654e+09   \n3                                              obr/esa        8.316103e+09   \n4                                      obr/esa_contrib        2.050599e+09   \n..                                                 ...                 ...   \n341  hmrc/savings_interest_income_count_income_band...        1.543184e+07   \n342  hmrc/dividend_income_income_band_55_12_570.0_t...        9.473187e+09   \n343  hmrc/dividend_income_count_income_band_55_12_5...        2.712548e+06   \n344        dwp/uc_two_child_limit_affected_child_count        1.388513e+06   \n345    dwp/uc_two_child_limit_affected_household_count        3.951418e+05   \n\n     target_simulated  error_simulated  abs_error_simulated  \\\n0        8.300000e+09    -3.687392e+09         3.687392e+09   \n1        4.500000e+09    -9.211583e+08         9.211583e+08   \n2        8.000000e+09    -3.045346e+09         3.045346e+09   \n3        7.900000e+09     4.161031e+08         4.161031e+08   \n4        5.000000e+09    -2.949401e+09         2.949401e+09   \n..                ...              ...                  ...   \n341      1.168678e+07     3.745061e+06         3.745061e+06   \n342      9.838981e+10    -8.891662e+10         8.891662e+10   \n343      3.981047e+06    -1.268499e+06         1.268499e+06   \n344      1.792000e+06    -4.034872e+05         4.034872e+05   \n345      4.928000e+05    -9.765821e+04         9.765821e+04   \n\n     rel_error_simulated  abs_rel_error_simulated type_simulated  \\\n0              -0.444264                 0.444264    Tax-benefit   \n1              -0.204702                 0.204702    Tax-benefit   \n2              -0.380668                 0.380668    Tax-benefit   \n3               0.052671                 0.052671    Tax-benefit   \n4              -0.589880                 0.589880    Tax-benefit   \n..                   ...                      ...            ...   \n341             0.320453                 0.320453         Income   \n342            -0.903718                 0.903718         Income   \n343            -0.318635                 0.318635         Income   \n344            -0.225160                 0.225160          Other   \n345            -0.198170                 0.198170          Other   \n\n     estimate_imputed  target_imputed  error_imputed  abs_error_imputed  \\\n0        4.612608e+09    8.300000e+09  -3.687392e+09       3.687392e+09   \n1        3.578842e+09    4.500000e+09  -9.211583e+08       9.211583e+08   \n2        4.954654e+09    8.000000e+09  -3.045346e+09       3.045346e+09   \n3        8.316103e+09    7.900000e+09   4.161031e+08       4.161031e+08   \n4        2.050599e+09    5.000000e+09  -2.949401e+09       2.949401e+09   \n..                ...             ...            ...                ...   \n341      1.543184e+07    1.168678e+07   3.745061e+06       3.745061e+06   \n342      9.473187e+09    9.838981e+10  -8.891662e+10       8.891662e+10   \n343      2.712548e+06    3.981047e+06  -1.268499e+06       1.268499e+06   \n344      1.394255e+06    1.792000e+06  -3.977453e+05       3.977453e+05   \n345      3.970558e+05    4.928000e+05  -9.574423e+04       9.574423e+04   \n\n     rel_error_imputed  abs_rel_error_imputed type_imputed  \\\n0            -0.444264               0.444264  Tax-benefit   \n1            -0.204702               0.204702  Tax-benefit   \n2            -0.380668               0.380668  Tax-benefit   \n3             0.052671               0.052671  Tax-benefit   \n4            -0.589880               0.589880  Tax-benefit   \n..                 ...                    ...          ...   \n341           0.320453               0.320453       Income   \n342          -0.903718               0.903718       Income   \n343          -0.318635               0.318635       Income   \n344          -0.221956               0.221956        Other   \n345          -0.194286               0.194286        Other   \n\n     change_in_abs_rel_error  \n0                   0.000000  \n1                   0.000000  \n2                   0.000000  \n3                   0.000000  \n4                   0.000000  \n..                       ...  \n341                 0.000000  \n342                 0.000000  \n343                 0.000000  \n344                -0.003204  \n345                -0.003884  \n\n[346 rows x 16 columns]","content_type":"text/plain"}}}],"key":"cEAPaXqkbz"}],"key":"ZLqazmgaQ8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Calibration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qnAyqP97di"}],"identifier":"calibration","label":"Calibration","html_id":"calibration","implicit":true,"key":"NfbxGbHUcK"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now, we’ve got a dataset that’s performs pretty well without explicitly targeting the official statistics we care about. So it’s time to add the final touch- calibrating the weights to explicitly minimise error against the target set.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"C9lTUaIj4x"}],"key":"CE4xOrRkNE"}],"key":"hSaFAcAqa1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"calibrated_loss = get_loss(ReweightedFRS_2022_23, None, 2025).copy()\ncalibrated_loss_against_imputed = pd.merge(\n    on=\"name\",\n    left=new_loss,\n    right=calibrated_loss,\n    suffixes=(\"_imputed\", \"_calibrated\"),\n)\n\ncalibrated_loss_against_imputed[\"change_in_abs_rel_error\"] = (\n    calibrated_loss_against_imputed[\"abs_rel_error_calibrated\"]\n    - calibrated_loss_against_imputed[\"abs_rel_error_imputed\"]\n)\ncalibrated_loss_against_imputed","key":"XjzosE9CoU"},{"type":"output","id":"_m4Np0EKxvJ_uRRD8pD2T","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"ab706fddfb6249fbb88f35ccf0e519fd","path":"/policyengine-uk-data/build/ab706fddfb6249fbb88f35ccf0e519fd.html"},"text/plain":{"content":"                                                  name  estimate_imputed  \\\n0                             obr/attendance_allowance      4.612608e+09   \n1                                 obr/carers_allowance      3.578842e+09   \n2                                              obr/dla      4.954654e+09   \n3                                              obr/esa      8.316103e+09   \n4                                      obr/esa_contrib      2.050599e+09   \n..                                                 ...               ...   \n341  hmrc/savings_interest_income_count_income_band...      1.543184e+07   \n342  hmrc/dividend_income_income_band_55_12_570.0_t...      9.473187e+09   \n343  hmrc/dividend_income_count_income_band_55_12_5...      2.712548e+06   \n344        dwp/uc_two_child_limit_affected_child_count      1.394255e+06   \n345    dwp/uc_two_child_limit_affected_household_count      3.970558e+05   \n\n     target_imputed  error_imputed  abs_error_imputed  rel_error_imputed  \\\n0      8.300000e+09  -3.687392e+09       3.687392e+09          -0.444264   \n1      4.500000e+09  -9.211583e+08       9.211583e+08          -0.204702   \n2      8.000000e+09  -3.045346e+09       3.045346e+09          -0.380668   \n3      7.900000e+09   4.161031e+08       4.161031e+08           0.052671   \n4      5.000000e+09  -2.949401e+09       2.949401e+09          -0.589880   \n..              ...            ...                ...                ...   \n341    1.168678e+07   3.745061e+06       3.745061e+06           0.320453   \n342    9.838981e+10  -8.891662e+10       8.891662e+10          -0.903718   \n343    3.981047e+06  -1.268499e+06       1.268499e+06          -0.318635   \n344    1.792000e+06  -3.977453e+05       3.977453e+05          -0.221956   \n345    4.928000e+05  -9.574423e+04       9.574423e+04          -0.194286   \n\n     abs_rel_error_imputed type_imputed  estimate_calibrated  \\\n0                 0.444264  Tax-benefit         4.612608e+09   \n1                 0.204702  Tax-benefit         3.578842e+09   \n2                 0.380668  Tax-benefit         4.954654e+09   \n3                 0.052671  Tax-benefit         8.316103e+09   \n4                 0.589880  Tax-benefit         2.050599e+09   \n..                     ...          ...                  ...   \n341               0.320453       Income         1.543184e+07   \n342               0.903718       Income         9.473187e+09   \n343               0.318635       Income         2.712548e+06   \n344               0.221956        Other         1.401080e+06   \n345               0.194286        Other         3.990078e+05   \n\n     target_calibrated  error_calibrated  abs_error_calibrated  \\\n0         8.300000e+09     -3.687392e+09          3.687392e+09   \n1         4.500000e+09     -9.211583e+08          9.211583e+08   \n2         8.000000e+09     -3.045346e+09          3.045346e+09   \n3         7.900000e+09      4.161031e+08          4.161031e+08   \n4         5.000000e+09     -2.949401e+09          2.949401e+09   \n..                 ...               ...                   ...   \n341       1.168678e+07      3.745061e+06          3.745061e+06   \n342       9.838981e+10     -8.891662e+10          8.891662e+10   \n343       3.981047e+06     -1.268499e+06          1.268499e+06   \n344       1.792000e+06     -3.909197e+05          3.909197e+05   \n345       4.928000e+05     -9.379224e+04          9.379224e+04   \n\n     rel_error_calibrated  abs_rel_error_calibrated type_calibrated  \\\n0               -0.444264                  0.444264     Tax-benefit   \n1               -0.204702                  0.204702     Tax-benefit   \n2               -0.380668                  0.380668     Tax-benefit   \n3                0.052671                  0.052671     Tax-benefit   \n4               -0.589880                  0.589880     Tax-benefit   \n..                    ...                       ...             ...   \n341              0.320453                  0.320453          Income   \n342             -0.903718                  0.903718          Income   \n343             -0.318635                  0.318635          Income   \n344             -0.218147                  0.218147           Other   \n345             -0.190325                  0.190325           Other   \n\n     change_in_abs_rel_error  \n0              -2.488922e-09  \n1              -1.637949e-09  \n2              -1.590702e-09  \n3              -5.069128e-10  \n4               2.464501e-09  \n..                       ...  \n341             5.558785e-10  \n342            -1.934451e-10  \n343            -2.576399e-10  \n344            -3.808917e-03  \n345            -3.961013e-03  \n\n[346 rows x 16 columns]","content_type":"text/plain"}}}],"key":"Diljhtc7HK"}],"key":"nkJV51NTCA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s also look at incomes.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q99nbVEP3J"}],"key":"LQ9TemdqIw"}],"key":"CJZ0A6KLXV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"incomes = calibrated_loss[loss_results.type == \"Income\"]\nincomes[\"band\"] = incomes.name.apply(\n    lambda x: \"_\".join(x.split(\"band_\")[1].split(\"_\")[1:])\n)\nincomes[\"count\"] = incomes.name.apply(lambda x: \"count\" in x)\nincomes[\"variable\"] = incomes.name.apply(\n    lambda x: x.split(\"_income_band\")[0].split(\"_count\")[0].split(\"hmrc/\")[-1]\n)\n\nvariable = \"employment_income\"\ncount = True\nvariable_df = incomes[\n    (incomes.variable == variable) & (incomes[\"count\"] == count)\n]\n\nfig = px.bar(\n    variable_df,\n    x=\"band\",\n    y=[\n        \"target\",\n        \"estimate\",\n        \"error\",\n        \"rel_error\",\n        \"abs_error\",\n        \"abs_rel_error\",\n    ],\n    barmode=\"group\",\n    color_discrete_sequence=px.colors.qualitative.T10,\n)\nformat_fig(fig)","key":"efXmTPuW0i"},{"type":"output","id":"xoTgqagdj3MmRI1yq46C4","data":[{"output_type":"display_data","metadata":{},"data":{"application/vnd.plotly.v1+json":{"content":"{\"config\":{\"plotlyServerURL\":\"https://plot.ly\"},\"data\":[{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=target<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"target\",\"marker\":{\"color\":\"#4C78A8\",\"pattern\":{\"shape\":\"\"}},\"name\":\"target\",\"offsetgroup\":\"target\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[397648,2455344,6725705,5647922,3934646,3671529,1899912,979383,273418,199891,106487,51274,26864,26370022],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=estimate<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"estimate\",\"marker\":{\"color\":\"#F58518\",\"pattern\":{\"shape\":\"\"}},\"name\":\"estimate\",\"offsetgroup\":\"estimate\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[1023954.3214297295,1839525.9950885773,6387366.710470676,5448517.7086930275,3420158.3231887817,3675436.0024147034,1825305.0654945374,995032.6799602509,313195.4208712578,204920.7386112213,218245.16543912888,845.8313293457031,1075.3845977783203,25353579.347589016],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"error\",\"marker\":{\"color\":\"#E45756\",\"pattern\":{\"shape\":\"\"}},\"name\":\"error\",\"offsetgroup\":\"error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[626306.3214297295,-615818.0049114227,-338338.2895293236,-199404.2913069725,-514487.67681121826,3907.002414703369,-74606.93450546265,15649.679960250854,39777.42087125778,5029.7386112213135,111758.16543912888,-50428.1686706543,-25788.61540222168,-1016442.652410984],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=rel_error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"rel_error\",\"marker\":{\"color\":\"#72B7B2\",\"pattern\":{\"shape\":\"\"}},\"name\":\"rel_error\",\"offsetgroup\":\"rel_error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[1.5750269621115396,-0.2508072208665762,-0.0503052526879076,-0.035305779950036933,-0.1307583139146999,0.001064134973386665,-0.03926862639188691,0.015979121508389316,0.14548208556590195,0.025162406567685956,1.0495005534866122,-0.9835036991585266,-0.9599693047283234,-0.038545385074422164],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=abs_error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"abs_error\",\"marker\":{\"color\":\"#54A24B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"abs_error\",\"offsetgroup\":\"abs_error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[626306.3214297295,615818.0049114227,338338.2895293236,199404.2913069725,514487.67681121826,3907.002414703369,74606.93450546265,15649.679960250854,39777.42087125778,5029.7386112213135,111758.16543912888,50428.1686706543,25788.61540222168,1016442.652410984],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=abs_rel_error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"abs_rel_error\",\"marker\":{\"color\":\"#EECA3B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"abs_rel_error\",\"offsetgroup\":\"abs_rel_error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[1.5750269621115396,0.2508072208665762,0.0503052526879076,0.035305779950036933,0.1307583139146999,0.001064134973386665,0.03926862639188691,0.015979121508389316,0.14548208556590195,0.025162406567685956,1.0495005534866122,0.9835036991585266,0.9599693047283234,0.038545385074422164],\"yaxis\":\"y\"}],\"layout\":{\"barmode\":\"group\",\"legend\":{\"title\":{\"text\":\"_variable\"},\"tracegroupgap\":0},\"margin\":{\"t\":60},\"template\":{\"data\":{\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"contour\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"heatmap\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"sequentialminus\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"geo\":{\"bgcolor\":\"white\",\"lakecolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"white\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"bgcolor\":\"#E5ECF6\",\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"bgcolor\":\"#E5ECF6\",\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0,1],\"title\":{\"text\":\"band\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0,1],\"title\":{\"text\":\"value\"}}}}","content_type":"application/vnd.plotly.v1+json"}}}],"key":"oJ0j7i5uFj"}],"key":"Vh5oWP8p9P"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So, what’s happening here seems like: the FRS just doesn’t have enough high-income records for calibration to work straight away. The optimiser can’t just set really high weights for the few rich people we do have, because it’d hurt performance on the demographic statistics.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SX2FrCMq9b"}],"key":"TiXI6LCgeg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"So, we need a solution to add more high-income records. What we’ll do is:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xcVs3WnrJX"}],"key":"LwIWI3wnpd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Train a QRF model to predict the distributions of income variables from the Survey of Personal Incomes from FRS demographic variables.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kwoPXhSAzt"}],"key":"X3KhW1bxZV"}],"key":"KnFZ982Ol1"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For each FRS person, add an ‘imputed income’ clone with zero weight.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"muSNgnIW9k"}],"key":"FCpkTkoNJL"}],"key":"Zez9gTdqqq"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Run the calibration again.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"g1o25YT85U"}],"key":"itbl8qRKRU"}],"key":"HvRdhiGtwL"}],"key":"kehwTIVONV"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The Enhanced FRS","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"oNKyEXcMgT"}],"identifier":"the-enhanced-frs","label":"The Enhanced FRS","html_id":"the-enhanced-frs","implicit":true,"key":"PRJROQXrVQ"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Let’s see how this new dataset performs.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"LlBgcRPBUY"}],"key":"EtF9oT6f7e"}],"key":"C2XQgnMF18"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"efrs_loss = get_loss(EnhancedFRS_2022_23, None, 2025).copy()\nefrs_loss_against_calibrated = pd.merge(\n    on=\"name\",\n    left=calibrated_loss,\n    right=efrs_loss,\n    suffixes=(\"_calibrated\", \"_enhanced\"),\n)\nefrs_loss_against_calibrated[\"change_in_abs_rel_error\"] = (\n    efrs_loss_against_calibrated[\"abs_rel_error_enhanced\"]\n    - efrs_loss_against_calibrated[\"abs_rel_error_calibrated\"]\n)\nefrs_loss_against_calibrated","key":"BD4xxytD0q"},{"type":"output","id":"Z-3-h7Uz7oJuViWhAX3hH","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"69fb4f76956063e21a35d5030d5994bc","path":"/policyengine-uk-data/build/69fb4f76956063e21a35d5030d5994bc.html"},"text/plain":{"content":"                                                  name  estimate_calibrated  \\\n0                             obr/attendance_allowance         4.612608e+09   \n1                                 obr/carers_allowance         3.578842e+09   \n2                                              obr/dla         4.954654e+09   \n3                                              obr/esa         8.316103e+09   \n4                                      obr/esa_contrib         2.050599e+09   \n..                                                 ...                  ...   \n341  hmrc/savings_interest_income_count_income_band...         1.543184e+07   \n342  hmrc/dividend_income_income_band_55_12_570.0_t...         9.473187e+09   \n343  hmrc/dividend_income_count_income_band_55_12_5...         2.712548e+06   \n344        dwp/uc_two_child_limit_affected_child_count         1.401080e+06   \n345    dwp/uc_two_child_limit_affected_household_count         3.990078e+05   \n\n     target_calibrated  error_calibrated  abs_error_calibrated  \\\n0         8.300000e+09     -3.687392e+09          3.687392e+09   \n1         4.500000e+09     -9.211583e+08          9.211583e+08   \n2         8.000000e+09     -3.045346e+09          3.045346e+09   \n3         7.900000e+09      4.161031e+08          4.161031e+08   \n4         5.000000e+09     -2.949401e+09          2.949401e+09   \n..                 ...               ...                   ...   \n341       1.168678e+07      3.745061e+06          3.745061e+06   \n342       9.838981e+10     -8.891662e+10          8.891662e+10   \n343       3.981047e+06     -1.268499e+06          1.268499e+06   \n344       1.792000e+06     -3.909197e+05          3.909197e+05   \n345       4.928000e+05     -9.379224e+04          9.379224e+04   \n\n     rel_error_calibrated  abs_rel_error_calibrated type_calibrated  \\\n0               -0.444264                  0.444264     Tax-benefit   \n1               -0.204702                  0.204702     Tax-benefit   \n2               -0.380668                  0.380668     Tax-benefit   \n3                0.052671                  0.052671     Tax-benefit   \n4               -0.589880                  0.589880     Tax-benefit   \n..                    ...                       ...             ...   \n341              0.320453                  0.320453          Income   \n342             -0.903718                  0.903718          Income   \n343             -0.318635                  0.318635          Income   \n344             -0.218147                  0.218147           Other   \n345             -0.190325                  0.190325           Other   \n\n     estimate_enhanced  target_enhanced  error_enhanced  abs_error_enhanced  \\\n0         8.843401e+09     8.300000e+09    5.434008e+08        5.434008e+08   \n1         4.621193e+09     4.500000e+09    1.211928e+08        1.211928e+08   \n2         8.275412e+09     8.000000e+09    2.754121e+08        2.754121e+08   \n3         8.364385e+09     7.900000e+09    4.643852e+08        4.643852e+08   \n4         5.338840e+09     5.000000e+09    3.388399e+08        3.388399e+08   \n..                 ...              ...             ...                 ...   \n341       1.262857e+07     1.168678e+07    9.417921e+05        9.417921e+05   \n342       8.753486e+10     9.838981e+10   -1.085495e+10        1.085495e+10   \n343       4.199668e+06     3.981047e+06    2.186210e+05        2.186210e+05   \n344       1.851749e+06     1.792000e+06    5.974919e+04        5.974919e+04   \n345       5.274306e+05     4.928000e+05    3.463056e+04        3.463056e+04   \n\n     rel_error_enhanced  abs_rel_error_enhanced type_enhanced  \\\n0              0.065470                0.065470   Tax-benefit   \n1              0.026932                0.026932   Tax-benefit   \n2              0.034427                0.034427   Tax-benefit   \n3              0.058783                0.058783   Tax-benefit   \n4              0.067768                0.067768   Tax-benefit   \n..                  ...                     ...           ...   \n341            0.080586                0.080586        Income   \n342           -0.110326                0.110326        Income   \n343            0.054915                0.054915        Income   \n344            0.033342                0.033342         Other   \n345            0.070273                0.070273         Other   \n\n     change_in_abs_rel_error  \n0                  -0.378794  \n1                  -0.177770  \n2                  -0.346242  \n3                   0.006112  \n4                  -0.522112  \n..                       ...  \n341                -0.239867  \n342                -0.793392  \n343                -0.263719  \n344                -0.184805  \n345                -0.120052  \n\n[346 rows x 16 columns]","content_type":"text/plain"}}}],"key":"Bt4Iyy7fMz"}],"key":"Dmq5gSKr3W"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And finally, let’s look at those incomes again.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pgtt0G1hXp"}],"key":"AwLHQmqC1b"}],"key":"bL3KQQLp3s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"incomes = efrs_loss[loss_results.type == \"Income\"]\nincomes[\"band\"] = incomes.name.apply(\n    lambda x: \"_\".join(x.split(\"band_\")[1].split(\"_\")[1:])\n)\nincomes[\"count\"] = incomes.name.apply(lambda x: \"count\" in x)\nincomes[\"variable\"] = incomes.name.apply(\n    lambda x: x.split(\"_income_band\")[0].split(\"_count\")[0].split(\"hmrc/\")[-1]\n)\n\nvariable = \"employment_income\"\ncount = True\nvariable_df = incomes[\n    (incomes.variable == variable) & (incomes[\"count\"] == count)\n]\n\nfig = px.bar(\n    variable_df,\n    x=\"band\",\n    y=[\n        \"target\",\n        \"estimate\",\n        \"error\",\n        \"rel_error\",\n        \"abs_error\",\n        \"abs_rel_error\",\n    ],\n    barmode=\"group\",\n    color_discrete_sequence=px.colors.qualitative.T10,\n)\nformat_fig(fig)","key":"zu86NNXTVv"},{"type":"output","id":"g-4lTUwmJTz2zTfEpmgNz","data":[{"output_type":"display_data","metadata":{},"data":{"application/vnd.plotly.v1+json":{"content":"{\"config\":{\"plotlyServerURL\":\"https://plot.ly\"},\"data\":[{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=target<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"target\",\"marker\":{\"color\":\"#4C78A8\",\"pattern\":{\"shape\":\"\"}},\"name\":\"target\",\"offsetgroup\":\"target\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[397648,2455344,6725705,5647922,3934646,3671529,1899912,979383,273418,199891,106487,51274,26864,26370022],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=estimate<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"estimate\",\"marker\":{\"color\":\"#F58518\",\"pattern\":{\"shape\":\"\"}},\"name\":\"estimate\",\"offsetgroup\":\"estimate\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[424929.4157104627,2755465.212850427,6533007.065547457,4945050.751680973,3013761.295757721,4916156.5820896905,2566013.944689396,1606618.6615459488,304110.76789712394,217559.91823041387,115103.32235789967,49768.71192988932,21825.629729905864,27469371.2800173],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"error\",\"marker\":{\"color\":\"#E45756\",\"pattern\":{\"shape\":\"\"}},\"name\":\"error\",\"offsetgroup\":\"error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[27281.415710462723,300121.2128504268,-192697.93445254304,-702871.248319027,-920884.7042422788,1244627.5820896905,666101.9446893958,627235.6615459488,30692.767897123937,17668.918230413867,8616.32235789967,-1505.288070110677,-5038.370270094136,1099349.2800173014],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=rel_error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"rel_error\",\"marker\":{\"color\":\"#72B7B2\",\"pattern\":{\"shape\":\"\"}},\"name\":\"rel_error\",\"offsetgroup\":\"rel_error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[0.06860694813116808,0.12223183914369098,-0.028650964389984847,-0.12444776119766296,-0.23404512229112323,0.3389943487004162,0.3505962090293634,0.6404396048797547,0.11225584232612314,0.0883927652091083,0.08091431214983678,-0.029357726530223446,-0.18755100767175908,0.04168935771146878],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=abs_error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"abs_error\",\"marker\":{\"color\":\"#54A24B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"abs_error\",\"offsetgroup\":\"abs_error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[27281.415710462723,300121.2128504268,192697.93445254304,702871.248319027,920884.7042422788,1244627.5820896905,666101.9446893958,627235.6615459488,30692.767897123937,17668.918230413867,8616.32235789967,1505.288070110677,5038.370270094136,1099349.2800173014],\"yaxis\":\"y\"},{\"alignmentgroup\":\"True\",\"hovertemplate\":\"_variable=abs_rel_error<br>band=%{x}<br>value=%{y}<extra></extra>\",\"legendgroup\":\"abs_rel_error\",\"marker\":{\"color\":\"#EECA3B\",\"pattern\":{\"shape\":\"\"}},\"name\":\"abs_rel_error\",\"offsetgroup\":\"abs_rel_error\",\"orientation\":\"v\",\"showlegend\":true,\"textposition\":\"auto\",\"type\":\"bar\",\"x\":[\"12_570.0_to_15_000.0\",\"15_000.0_to_20_000.0\",\"20_000.0_to_30_000.0\",\"30_000.0_to_40_000.0\",\"40_000.0_to_50_000.0\",\"50_000.0_to_70_000.0\",\"70_000.0_to_100_000.0\",\"100_000.0_to_150_000.0\",\"150_000.0_to_200_000.0\",\"200_000.0_to_300_000.0\",\"300_000.0_to_500_000.0\",\"500_000.0_to_1_000_000.0\",\"1_000_000.0_to_inf\",\"12_570.0_to_inf\"],\"xaxis\":\"x\",\"y\":[0.06860694813116808,0.12223183914369098,0.028650964389984847,0.12444776119766296,0.23404512229112323,0.3389943487004162,0.3505962090293634,0.6404396048797547,0.11225584232612314,0.0883927652091083,0.08091431214983678,0.029357726530223446,0.18755100767175908,0.04168935771146878],\"yaxis\":\"y\"}],\"layout\":{\"barmode\":\"group\",\"legend\":{\"title\":{\"text\":\"_variable\"},\"tracegroupgap\":0},\"margin\":{\"t\":60},\"template\":{\"data\":{\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"contour\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"heatmap\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"sequentialminus\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"geo\":{\"bgcolor\":\"white\",\"lakecolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"white\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"bgcolor\":\"#E5ECF6\",\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"gridwidth\":2,\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"bgcolor\":\"#E5ECF6\",\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0,1],\"title\":{\"text\":\"band\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0,1],\"title\":{\"text\":\"value\"}}}}","content_type":"application/vnd.plotly.v1+json"}}}],"key":"zrYZetFhR6"}],"key":"Qf1OYB2c0i"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Everything looks healthy here! We’ve got a dataset that’s close to reality, and we can have confidence in our tax-benefit model.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LYMJxBsn8i"}],"key":"mgvIG7lPNN"}],"key":"MujkN1zS27"}],"key":"hSnAPlYXWp"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"PolicyEngine UK data","url":"/","group":"PolicyEngine UK data"},"next":{"title":"Validation","url":"/validation","group":"PolicyEngine UK data"}}},"domain":"http://localhost:3000"}