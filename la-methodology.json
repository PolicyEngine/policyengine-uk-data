{"version":2,"kind":"Notebook","sha256":"012da5dc9408ff0a40da613893e4dedaa5ff708fc90023b0f99146d87337ea99","slug":"la-methodology","location":"/LA_methodology.ipynb","dependencies":[],"frontmatter":{"title":"Local authority methodology","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"base","language":"python"},"authors":[{"nameParsed":{"given":"PolicyEngine","family":"Team","literal":"PolicyEngine Team"},"name":"PolicyEngine Team","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/policyengine/policyengine-uk-data","copyright":"2024","source_url":"https://github.com/policyengine/policyengine-uk-data/blob/main/docs/LA_methodology.ipynb","edit_url":"https://github.com/policyengine/policyengine-uk-data/edit/main/docs/LA_methodology.ipynb","thumbnail":"/policyengine-uk-data/build/nomis_screenshot2-87ccebeb16251bd114856327df9b29f7.png","exports":[{"format":"ipynb","filename":"LA_methodology.ipynb","url":"/policyengine-uk-data/build/LA_methodology-9a96c447216931b06ddae4289b13d497.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A9sHPe9oD5"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"V8Z7VYGUUc"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"When policy changes in the UK - taxes, benefits, or public spending - it affects places and people differently. PolicyEngine UK builds tools to analyze incomes, jobs, and population patterns in each local authoirity district. This documentation explains how we create a microsimulation model that works at the local authoirity level. The system combines workplace surveys of jobs and earnings, HMRC tax records, and population statistics. We estimate income distributions, and optimize geographic weights.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"USkbCx2Yki"}],"key":"eJUFW31gbW"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This guide shows how to use PolicyEngine UK for local authoirity analysis. We start with data collection, transform it for modeling, and build tools to examine policies. The guide provides examples and code to implement these methods. Users can measure changes in household budgets, track employment, and understand economic patterns on different local authoirity districts. This document starts with data collection from workplace surveys, tax records, and population counts, then explains how we convert this data into usable forms through income brackets. It concludes with technical details about accuracy measurement and calibration, plus example code for analysis and visualization.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KVd69OkFzx"}],"key":"d44XgFsZyL"}],"key":"regy8BRLSe"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G3SReZjseQ"}],"identifier":"data","label":"Data","html_id":"data","implicit":true,"key":"qv5oQrR2Mz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this section, we describe three main data sources that form the foundation of our local authority level analysis: earning and jobs data from NOMIS ASHE, income statistics from HMRC, and population age distributions from the House of Commons Library.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"awKQC1wphZ"}],"key":"m533aPCiFf"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Earning and jobs data","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VJct7HBWzt"}],"identifier":"earning-and-jobs-data","label":"Earning and jobs data","html_id":"earning-and-jobs-data","implicit":true,"key":"cYje7K9bH5"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Data is extracted from NOMIS Annual Survey of Hours and Earnings (ASHE) - workplace analysis dataset, containing number of jobs and earnings percentiles for all UK local authority districts from the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"HtmtaJhtL2"},{"type":"link","url":"https://www.nomisweb.co.uk/datasets/ashe","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"NOMIS website","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"O7JPH6hI84"}],"urlSource":"https://www.nomisweb.co.uk/datasets/ashe","key":"USndtXTlLp"},{"type":"text","value":". This dataset is stored as ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qCEpmMc4W2"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/nomis_earning_jobs_data.xlsx","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineCode","value":"nomis_earning_jobs_data.xlsx","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"oTGejYsq9R"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/nomis_earning_jobs_data.xlsx","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/nomis_earning_jobs_data.xlsx","raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/nomis_earning_jobs_data.xlsx"},"internal":false,"protocol":"github","key":"cv9IbiECaf"},{"type":"text","value":". To download the data, follow the variable selection process shown in the image below:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"O0Jwpofc4U"}],"key":"KaLYKb4wlr"},{"type":"image","url":"/policyengine-uk-data/build/nomis_screenshot2-87ccebeb16251bd114856327df9b29f7.png","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TWM7Xa7lEs","urlSource":"pictures/nomis_screenshot2.png"}],"key":"Bomw4LOs1C"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Income data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EgRo2MAf2L"}],"identifier":"income-data","label":"Income data","html_id":"income-data","implicit":true,"key":"AJB2xuGHql"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Income data for UK local authorities is obtained from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aRnlZk0zLh"},{"type":"link","url":"https://www.gov.uk/government/statistics/income-and-tax-by-borough-and-district-or-unitary-authority-confidence-intervals","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"HMRC","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IzuhiP0CQT"}],"urlSource":"https://www.gov.uk/government/statistics/income-and-tax-by-borough-and-district-or-unitary-authority-confidence-intervals","key":"ZaQWV9tmar"},{"type":"text","value":". This dataset provides detailed information about income and tax by local authorities with confidence intervals, and is stored as ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iTaRoPZWNJ"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"total_income.csv","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LePzUEIB1N"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv","raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv"},"internal":false,"protocol":"github","key":"aGckFB8VXd"},{"type":"text","value":", including two key variables:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xJHvubMux0"}],"key":"YEujnuZp76"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv#L1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"total_income_count","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"z0OV5OF1gI"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv#L1","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv","from":1,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv"},"internal":false,"protocol":"github","key":"ckRjm0VNrt"},{"type":"text","value":": the total number of taxpayers in each local authority","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cblVRTO73Z"}],"key":"sYGuuPExEP"}],"key":"TB9AjVDwwS"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv#L1","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineCode","value":"total_income_amount","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"EwNek4Oyjl"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv#L1","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv","from":1,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv"},"internal":false,"protocol":"github","key":"IWrWu8fnoc"},{"type":"text","value":": the total amount of income for all taxpayers in each local authority","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"shcW2545Tc"}],"key":"Duy13Ou4nQ"}],"key":"HXkopxlVuR"}],"key":"z5H3v3zhha"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"We use these measures to identify similar local authorities when employment distribution data is missing. Our approach assumes that local authorities with similar income patterns (measured by both taxpayer counts and total income) will have similar earnings distributions. The following table shows the dataset:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fNF8F3F6Fs"}],"key":"kPsRNshQxD"}],"key":"GanvtGVwAs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nfrom itables import init_notebook_mode, show\nimport itables.options as opt\nopt.maxBytes = \"1MB\"\ninit_notebook_mode(all_interactive=True)\n\npd.read_csv(\"../policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv\")","key":"jA6C3Sptzx"},{"type":"output","id":"0rH8kqKjCfOZMFIzHXDrj","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<script>\n    let is_dark_theme = function () {\n        // Jupyter Lab\n        if ('jpThemeLight' in document.body.dataset)\n            return (document.body.dataset.jpThemeLight === \"false\");\n\n        // VS Code\n        if ('vscodeThemeKind' in document.body.dataset)\n            return document.body.dataset.vscodeThemeKind.includes('dark');\n\n        // Jupyter Book\n        if ('theme' in document.documentElement.dataset)\n            return document.documentElement.dataset.theme.includes('dark');\n\n        // Default\n        return window.matchMedia('(prefers-color-scheme: dark)').matches;\n    }\n\n    if (is_dark_theme()) {\n        document.documentElement.classList.add('dark');\n    }\n    else {\n        document.documentElement.classList.remove('dark');\n    }\n</script>\n","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"c6ab3fbdab1ff94600e51c14dfe3f701","path":"/policyengine-uk-data/build/c6ab3fbdab1ff94600e51c14dfe3f701.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<table id=\"itables_ca83706d_e848_4a3e_bd7f_85ea375d7d62\" class=\"display nowrap\" data-quarto-disable-processing=\"true\" style=\"table-layout:auto;width:auto;margin:auto;caption-side:bottom\">\n<thead>\n    <tr style=\"text-align: right;\">\n      \n      <th>code</th>\n      <th>name</th>\n      <th>total_income_count</th>\n      <th>total_income_amount</th>\n    </tr>\n  </thead><tbody><tr>\n<td style=\"vertical-align:middle; text-align:left\">\n<div style=\"float:left; margin-right: 10px;\">\n<a href=https://mwouts.github.io/itables/><svg class=\"main-svg\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"\nwidth=\"64\" viewBox=\"0 0 500 400\" style=\"font-family: 'Droid Sans', sans-serif;\">\n    <g style=\"fill:#d9d7fc\">\n        <path d=\"M100,400H500V357H100Z\" />\n        <path d=\"M100,300H400V257H100Z\" />\n        <path d=\"M0,200H400V157H0Z\" />\n        <path d=\"M100,100H500V57H100Z\" />\n        <path d=\"M100,350H500V307H100Z\" />\n        <path d=\"M100,250H400V207H100Z\" />\n        <path d=\"M0,150H400V107H0Z\" />\n        <path d=\"M100,50H500V7H100Z\" />\n    </g>\n    <g style=\"fill:#1a1366;stroke:#1a1366;\">\n   <rect x=\"100\" y=\"7\" width=\"400\" height=\"43\">\n    <animate\n      attributeName=\"width\"\n      values=\"0;400;0\"\n      dur=\"5s\"\n      repeatCount=\"indefinite\" />\n      <animate\n      attributeName=\"x\"\n      values=\"100;100;500\"\n      dur=\"5s\"\n      repeatCount=\"indefinite\" />\n  </rect>\n        <rect x=\"0\" y=\"107\" width=\"400\" height=\"43\">\n    <animate\n      attributeName=\"width\"\n      values=\"0;400;0\"\n      dur=\"3.5s\"\n      repeatCount=\"indefinite\" />\n    <animate\n      attributeName=\"x\"\n      values=\"0;0;400\"\n      dur=\"3.5s\"\n      repeatCount=\"indefinite\" />\n  </rect>\n        <rect x=\"100\" y=\"207\" width=\"300\" height=\"43\">\n    <animate\n      attributeName=\"width\"\n      values=\"0;300;0\"\n      dur=\"3s\"\n      repeatCount=\"indefinite\" />\n    <animate\n      attributeName=\"x\"\n      values=\"100;100;400\"\n      dur=\"3s\"\n      repeatCount=\"indefinite\" />\n  </rect>\n        <rect x=\"100\" y=\"307\" width=\"400\" height=\"43\">\n    <animate\n      attributeName=\"width\"\n      values=\"0;400;0\"\n      dur=\"4s\"\n      repeatCount=\"indefinite\" />\n      <animate\n      attributeName=\"x\"\n      values=\"100;100;500\"\n      dur=\"4s\"\n      repeatCount=\"indefinite\" />\n  </rect>\n        <g style=\"fill:transparent;stroke-width:8; stroke-linejoin:round\" rx=\"5\">\n            <g transform=\"translate(45 50) rotate(-45)\">\n                <circle r=\"33\" cx=\"0\" cy=\"0\" />\n                <rect x=\"-8\" y=\"32\" width=\"16\" height=\"30\" />\n            </g>\n\n            <g transform=\"translate(450 152)\">\n                <polyline points=\"-15,-20 -35,-20 -35,40 25,40 25,20\" />\n                <rect x=\"-15\" y=\"-40\" width=\"60\" height=\"60\" />\n            </g>\n\n            <g transform=\"translate(50 352)\">\n                <polygon points=\"-35,-5 0,-40 35,-5\" />\n                <polygon points=\"-35,10 0,45 35,10\" />\n            </g>\n\n            <g transform=\"translate(75 250)\">\n                <polyline points=\"-30,30 -60,0 -30,-30\" />\n                <polyline points=\"0,30 -30,0 0,-30\" />\n            </g>\n\n            <g transform=\"translate(425 250) rotate(180)\">\n                <polyline points=\"-30,30 -60,0 -30,-30\" />\n                <polyline points=\"0,30 -30,0 0,-30\" />\n            </g>\n        </g>\n    </g>\n</svg>\n</a>\n</div>\n<div>\nLoading ITables v2.2.3 from the <code>init_notebook_mode</code> cell...\n(need <a href=https://mwouts.github.io/itables/troubleshooting.html>help</a>?)</td>\n</div>\n</tr></tbody>\n</table>\n<script type=\"module\">\n    const { DataTable, jQuery: $ } = await import(window._datatables_src_for_itables_2_2_3);\n\n    document.querySelectorAll(\"#itables_ca83706d_e848_4a3e_bd7f_85ea375d7d62:not(.dataTable)\").forEach(table => {\n        if (!(table instanceof HTMLTableElement))\n            return;\n\n        // Define the table data\n        const data = [[\"E06000001\", \"Hartlepool UA\", 41000.0, 1258700000.0], [\"E06000002\", \"Middlesbrough UA\", 60000.0, 1812000000.0], [\"E06000003\", \"Redcar and Cleveland UA\", 65000.0, 1885000000.0], [\"E06000004\", \"Stockton-on-Tees UA\", 91000.0, 3039400000.0], [\"E06000005\", \"Darlington UA\", 52000.0, 1653600000.0], [\"E06000006\", \"Halton UA\", 61000.0, 1921500000.0], [\"E06000007\", \"Warrington UA\", 116000.0, 4245600000.0], [\"E06000008\", \"Blackburn with Darwen UA\", 63000.0, 1890000000.0], [\"E06000009\", \"Blackpool UA\", 60000.0, 1554000000.0], [\"E06000010\", \"Kingston upon Hull UA\", 113000.0, 3039700000.0], [\"E06000011\", \"East Riding of Yorkshire UA\", 180000.0, 6174000000.0], [\"E06000012\", \"North East Lincolnshire UA\", 70000.0, 2177000000.0], [\"E06000013\", \"North Lincolnshire UA\", 83000.0, 2556400000.0], [\"E06000014\", \"York UA\", 102000.0, 3692400000.0], [\"E06000015\", \"Derby UA\", 115000.0, 3542000000.0], [\"E06000016\", \"Leicester UA\", 135000.0, 3739500000.0], [\"E06000017\", \"Rutland UA\", 20000.0, 974000000.0], [\"E06000018\", \"Nottingham UA\", 114000.0, 3385800000.0], [\"E06000019\", \"Herefordshire UA\", 96000.0, 3235200000.0], [\"E06000020\", \"Telford and Wrekin UA\", 91000.0, 2793700000.0], [\"E06000021\", \"Stoke-on-Trent UA\", 110000.0, 2948000000.0], [\"E06000022\", \"Bath and North East Somerset UA\", 99000.0, 4138200000.0], [\"E06000023\", \"Bristol UA\", 227000.0, 8285500000.0], [\"E06000024\", \"North Somerset UA\", 120000.0, 4404000000.0], [\"E06000025\", \"South Gloucestershire UA\", 156000.0, 5725200000.0], [\"E06000026\", \"Plymouth UA\", 131000.0, 3890700000.0], [\"E06000027\", \"Torbay UA\", 89380.28169, 3524250000.0], [\"E06000030\", \"Swindon UA\", 121000.0, 4198700000.0], [\"E06000031\", \"Peterborough UA\", 97000.0, 3074900000.0], [\"E06000032\", \"Luton UA\", 89000.0, 2696700000.0], [\"E06000033\", \"Southend-on-Sea UA\", 84000.0, 3351600000.0], [\"E06000034\", \"Thurrock UA\", 89000.0, 3177300000.0], [\"E06000035\", \"Medway Towns UA\", 138000.0, 4761000000.0], [\"E06000036\", \"Bracknell Forest UA\", 68000.0, 3012400000.0], [\"E06000037\", \"West Berkshire UA\", 92000.0, 4305600000.0], [\"E06000038\", \"Reading UA\", 84000.0, 3452400000.0], [\"E06000039\", \"Slough UA\", 67000.0, 2318200000.0], [\"E06000040\", \"Windsor and Maidenhead UA\", 88000.0, 5438400000.0], [\"E06000041\", \"Wokingham UA\", 95000.0, 5054000000.0], [\"E06000042\", \"Milton Keynes UA\", 143000.0, 5519800000.0], [\"E06000043\", \"Brighton and Hove UA\", 134000.0, 5641400000.0], [\"E06000044\", \"Portsmouth UA\", 95000.0, 3030500000.0], [\"E06000045\", \"Southampton UA\", 115000.0, 3553500000.0], [\"E06000046\", \"Isle of Wight UA\", 66000.0, 2079000000.0], [\"E06000047\", \"County Durham UA\", 249000.0, 7544700000.0], [\"E06000049\", \"Cheshire East UA\", 221000.0, 10121800000.0], [\"E06000050\", \"Cheshire West and Chester UA\", 179000.0, 6784100000.0], [\"E06000051\", \"Shropshire UA\", 168000.0, 5863200000.0], [\"E06000052\", \"Cornwall UA\", 273000.0, 8517600000.0], [\"E06000053\", \"Isles of Scilly UA\", 89380.28169, 3524250000.0], [\"E06000054\", \"Wiltshire UA\", 272000.0, 10798400000.0], [\"E06000055\", \"Bedford UA\", 97000.0, 3695700000.0], [\"E06000056\", \"Central Bedfordshire UA\", 172000.0, 6673600000.0], [\"E06000057\", \"Northumberland UA\", 168000.0, 5611200000.0], [\"E06000058\", \"Bournemouth, Christchurch and Poole UA\", 201000.0, 7014900000.0], [\"E06000059\", \"Dorset UA\", 198000.0, 7048800000.0], [\"E06000060\", \"Buckinghamshire UA\", 309000.0, 16562400000.0], [\"E06000061\", \"North Northamptonshire UA\", 183000.0, 6313500000.0], [\"E06000062\", \"West Northamptonshire UA\", 230000.0, 8556000000.0], [\"E06000063\", \"Cumberland\", 89380.28169, 3524250000.0], [\"E06000064\", \"Westmorland and Furness\", 89380.28169, 3524250000.0], [\"E06000065\", \"North Yorkshire\", 89380.28169, 3524250000.0], [\"E06000066\", \"Somerset\", 89380.28169, 3524250000.0], [\"E07000008\", \"Cambridge\", 69000.0, 3394800000.0], [\"E07000009\", \"East Cambridgeshire\", 50000.0, 2010000000.0], [\"E07000010\", \"Fenland\", 52000.0, 1596400000.0], [\"E07000011\", \"Huntingdonshire\", 95000.0, 3695500000.0], [\"E07000012\", \"South Cambridgeshire\", 97000.0, 4723900000.0], [\"E07000032\", \"Amber Valley\", 65000.0, 2203500000.0], [\"E07000033\", \"Bolsover\", 38000.0, 1098200000.0], [\"E07000034\", \"Chesterfield\", 52000.0, 1554800000.0], [\"E07000035\", \"Derbyshire Dales\", 40000.0, 1512000000.0], [\"E07000036\", \"Erewash\", 58000.0, 1815400000.0], [\"E07000037\", \"High Peak\", 47000.0, 1626200000.0], [\"E07000038\", \"North East Derbyshire\", 52000.0, 1726400000.0], [\"E07000039\", \"South Derbyshire\", 59000.0, 2129900000.0], [\"E07000040\", \"East Devon\", 76000.0, 2728400000.0], [\"E07000041\", \"Exeter\", 60000.0, 2094000000.0], [\"E07000042\", \"Mid Devon\", 42000.0, 1440600000.0], [\"E07000043\", \"North Devon\", 47000.0, 1461700000.0], [\"E07000044\", \"South Hams\", 46000.0, 1729600000.0], [\"E07000045\", \"Teignbridge\", 71000.0, 2357200000.0], [\"E07000046\", \"Torridge\", 33000.0, 990000000.0], [\"E07000047\", \"West Devon\", 27000.0, 912600000.0], [\"E07000061\", \"Eastbourne\", 48000.0, 1502400000.0], [\"E07000062\", \"Hastings\", 39000.0, 1170000000.0], [\"E07000063\", \"Lewes\", 52000.0, 2059200000.0], [\"E07000064\", \"Rother\", 48000.0, 1852800000.0], [\"E07000065\", \"Wealden\", 85000.0, 3825000000.0], [\"E07000066\", \"Basildon\", 91000.0, 3521700000.0], [\"E07000067\", \"Braintree\", 82000.0, 3304600000.0], [\"E07000068\", \"Brentwood\", 41000.0, 2431300000.0], [\"E07000069\", \"Castle Point\", 46000.0, 1642200000.0], [\"E07000070\", \"Chelmsford\", 94000.0, 4361600000.0], [\"E07000071\", \"Colchester\", 96000.0, 3763200000.0], [\"E07000072\", \"Epping Forest\", 71000.0, 4820900000.0], [\"E07000073\", \"Harlow\", 44000.0, 1430000000.0], [\"E07000074\", \"Maldon\", 36000.0, 1422000000.0], [\"E07000075\", \"Rochford\", 47000.0, 1912900000.0], [\"E07000076\", \"Tendring\", 66000.0, 2085600000.0], [\"E07000077\", \"Uttlesford\", 54000.0, 2818800000.0], [\"E07000078\", \"Cheltenham\", 61000.0, 2446100000.0], [\"E07000079\", \"Cotswold\", 50000.0, 2525000000.0], [\"E07000080\", \"Forest of Dean\", 45000.0, 1408500000.0], [\"E07000081\", \"Gloucester\", 67000.0, 2010000000.0], [\"E07000082\", \"Stroud\", 64000.0, 2560000000.0], [\"E07000083\", \"Tewkesbury\", 53000.0, 1939800000.0], [\"E07000084\", \"Basingstoke and Deane\", 104000.0, 4586400000.0], [\"E07000085\", \"East Hampshire\", 70000.0, 3255000000.0], [\"E07000086\", \"Eastleigh\", 74000.0, 2797200000.0], [\"E07000087\", \"Fareham\", 62000.0, 2281600000.0], [\"E07000088\", \"Gosport\", 42000.0, 1360800000.0], [\"E07000089\", \"Hart\", 57000.0, 3021000000.0], [\"E07000090\", \"Havant\", 61000.0, 2025200000.0], [\"E07000091\", \"New Forest\", 93000.0, 3673500000.0], [\"E07000092\", \"Rushmoor\", 51000.0, 1785000000.0], [\"E07000093\", \"Test Valley\", 74000.0, 3167200000.0], [\"E07000094\", \"Winchester\", 67000.0, 3772100000.0], [\"E07000095\", \"Broxbourne\", 51000.0, 1938000000.0], [\"E07000096\", \"Dacorum\", 81000.0, 4082400000.0], [\"E07000098\", \"Hertsmere\", 60000.0, 3198000000.0], [\"E07000099\", \"North Hertfordshire\", 77000.0, 3580500000.0], [\"E07000102\", \"Three Rivers\", 49000.0, 2734200000.0], [\"E07000103\", \"Watford\", 53000.0, 2146500000.0], [\"E07000105\", \"Ashford\", 70000.0, 2674000000.0], [\"E07000106\", \"Canterbury\", 73000.0, 2722900000.0], [\"E07000107\", \"Dartford\", 59000.0, 2312800000.0], [\"E07000108\", \"Dover\", 60000.0, 1956000000.0], [\"E07000109\", \"Gravesham\", 54000.0, 1971000000.0], [\"E07000110\", \"Maidstone\", 93000.0, 3720000000.0], [\"E07000111\", \"Sevenoaks\", 68000.0, 4331600000.0], [\"E07000112\", \"Folkestone and Hythe\", 53000.0, 1860300000.0], [\"E07000113\", \"Swale\", 76000.0, 2568800000.0], [\"E07000114\", \"Thanet\", 65000.0, 2028000000.0], [\"E07000115\", \"Tonbridge and Malling\", 71000.0, 3337000000.0], [\"E07000116\", \"Tunbridge Wells\", 62000.0, 3453400000.0], [\"E07000117\", \"Burnley\", 39000.0, 1099800000.0], [\"E07000118\", \"Chorley\", 63000.0, 2198700000.0], [\"E07000119\", \"Fylde\", 45000.0, 1678500000.0], [\"E07000120\", \"Hyndburn\", 33000.0, 943800000.0], [\"E07000121\", \"Lancaster\", 65000.0, 2080000000.0], [\"E07000122\", \"Pendle\", 40000.0, 1120000000.0], [\"E07000123\", \"Preston\", 71000.0, 2215200000.0], [\"E07000124\", \"Ribble Valley\", 39000.0, 1454700000.0], [\"E07000125\", \"Rossendale\", 31000.0, 1069500000.0], [\"E07000126\", \"South Ribble\", 62000.0, 2052200000.0], [\"E07000127\", \"West Lancashire\", 57000.0, 2063400000.0], [\"E07000128\", \"Wyre\", 56000.0, 1825600000.0], [\"E07000129\", \"Blaby\", 55000.0, 1837000000.0], [\"E07000130\", \"Charnwood\", 90000.0, 3177000000.0], [\"E07000131\", \"Harborough\", 54000.0, 2386800000.0], [\"E07000132\", \"Hinckley and Bosworth\", 62000.0, 2151400000.0], [\"E07000133\", \"Melton\", 28000.0, 1019200000.0], [\"E07000134\", \"North West Leicestershire\", 57000.0, 2040600000.0], [\"E07000135\", \"Oadby and Wigston\", 27000.0, 982800000.0], [\"E07000136\", \"Boston\", 35000.0, 962500000.0], [\"E07000137\", \"East Lindsey\", 62000.0, 1816600000.0], [\"E07000138\", \"Lincoln\", 45000.0, 1345500000.0], [\"E07000139\", \"North Kesteven\", 61000.0, 2086200000.0], [\"E07000140\", \"South Holland\", 52000.0, 1580800000.0], [\"E07000141\", \"South Kesteven\", 76000.0, 2796800000.0], [\"E07000142\", \"West Lindsey\", 49000.0, 1729700000.0], [\"E07000143\", \"Breckland\", 72000.0, 2268000000.0], [\"E07000144\", \"Broadland\", 69000.0, 2339100000.0], [\"E07000145\", \"Great Yarmouth\", 48000.0, 1368000000.0], [\"E07000146\", \"King's Lynn and West Norfolk\", 75000.0, 2452500000.0], [\"E07000147\", \"North Norfolk\", 50000.0, 1625000000.0], [\"E07000148\", \"Norwich\", 67000.0, 2177500000.0], [\"E07000149\", \"South Norfolk\", 75000.0, 2775000000.0], [\"E07000170\", \"Ashfield\", 60000.0, 1716000000.0], [\"E07000171\", \"Bassetlaw\", 59000.0, 1935200000.0], [\"E07000172\", \"Broxtowe\", 58000.0, 1995200000.0], [\"E07000173\", \"Gedling\", 60000.0, 1968000000.0], [\"E07000174\", \"Mansfield\", 53000.0, 1542300000.0], [\"E07000175\", \"Newark and Sherwood\", 64000.0, 2188800000.0], [\"E07000176\", \"Rushcliffe\", 65000.0, 3009500000.0], [\"E07000177\", \"Cherwell\", 87000.0, 3514800000.0], [\"E07000178\", \"Oxford\", 70000.0, 3164000000.0], [\"E07000179\", \"South Oxfordshire\", 83000.0, 4556700000.0], [\"E07000180\", \"Vale of White Horse\", 78000.0, 3580200000.0], [\"E07000181\", \"West Oxfordshire\", 67000.0, 3035100000.0], [\"E07000192\", \"Cannock Chase\", 47000.0, 1410000000.0], [\"E07000193\", \"East Staffordshire\", 61000.0, 2092300000.0], [\"E07000194\", \"Lichfield\", 58000.0, 2285200000.0], [\"E07000195\", \"Newcastle-under-Lyme\", 64000.0, 2220800000.0], [\"E07000196\", \"South Staffordshire\", 62000.0, 2287800000.0], [\"E07000197\", \"Stafford\", 73000.0, 2628000000.0], [\"E07000198\", \"Staffordshire Moorlands\", 53000.0, 1669500000.0], [\"E07000199\", \"Tamworth\", 39000.0, 1201200000.0], [\"E07000200\", \"Babergh\", 50000.0, 1980000000.0], [\"E07000202\", \"Ipswich\", 71000.0, 2165500000.0], [\"E07000203\", \"Mid Suffolk\", 53000.0, 1998100000.0], [\"E07000207\", \"Elmbridge\", 76000.0, 7144000000.0], [\"E07000208\", \"Epsom and Ewell\", 44000.0, 2283600000.0], [\"E07000209\", \"Guildford\", 81000.0, 4770900000.0], [\"E07000210\", \"Mole Valley\", 48000.0, 2812800000.0], [\"E07000211\", \"Reigate and Banstead\", 84000.0, 4527600000.0], [\"E07000212\", \"Runnymede\", 47000.0, 2495700000.0], [\"E07000213\", \"Spelthorne\", 55000.0, 2282500000.0], [\"E07000214\", \"Surrey Heath\", 49000.0, 2582300000.0], [\"E07000215\", \"Tandridge\", 46000.0, 2764600000.0], [\"E07000216\", \"Waverley\", 75000.0, 4875000000.0], [\"E07000217\", \"Woking\", 57000.0, 3180600000.0], [\"E07000218\", \"North Warwickshire\", 32000.0, 1072000000.0], [\"E07000219\", \"Nuneaton and Bedworth\", 67000.0, 2050200000.0], [\"E07000220\", \"Rugby\", 64000.0, 2374400000.0], [\"E07000221\", \"Stratford-on-Avon\", 73000.0, 3518600000.0], [\"E07000222\", \"Warwick\", 83000.0, 3668600000.0], [\"E07000223\", \"Adur\", 31000.0, 1072600000.0], [\"E07000224\", \"Arun\", 83000.0, 2763900000.0], [\"E07000225\", \"Chichester\", 68000.0, 3094000000.0], [\"E07000226\", \"Crawley\", 56000.0, 1909600000.0], [\"E07000227\", \"Horsham\", 81000.0, 3669300000.0], [\"E07000228\", \"Mid Sussex\", 84000.0, 3981600000.0], [\"E07000229\", \"Worthing\", 60000.0, 2112000000.0], [\"E07000234\", \"Bromsgrove\", 53000.0, 2310800000.0], [\"E07000235\", \"Malvern Hills\", 40000.0, 1580000000.0], [\"E07000236\", \"Redditch\", 50000.0, 1620000000.0], [\"E07000237\", \"Worcester\", 52000.0, 1658800000.0], [\"E07000238\", \"Wychavon\", 68000.0, 2638400000.0], [\"E07000239\", \"Wyre Forest\", 51000.0, 1642200000.0], [\"E07000240\", \"St Albans\", 86000.0, 5908200000.0], [\"E07000241\", \"Welwyn Hatfield\", 57000.0, 2747400000.0], [\"E07000242\", \"East Hertfordshire\", 86000.0, 4429000000.0], [\"E07000243\", \"Stevenage\", 45000.0, 1615500000.0], [\"E07000244\", \"East Suffolk\", 121000.0, 4295500000.0], [\"E07000245\", \"West Suffolk\", 88000.0, 3159200000.0], [\"E08000001\", \"Bolton\", 127000.0, 3911600000.0], [\"E08000002\", \"Bury\", 92000.0, 3164800000.0], [\"E08000003\", \"Manchester\", 205000.0, 6642000000.0], [\"E08000004\", \"Oldham\", 96000.0, 2889600000.0], [\"E08000005\", \"Rochdale\", 91000.0, 2739100000.0], [\"E08000006\", \"Salford\", 126000.0, 4309200000.0], [\"E08000007\", \"Stockport\", 155000.0, 5797000000.0], [\"E08000008\", \"Tameside\", 106000.0, 3137600000.0], [\"E08000009\", \"Trafford\", 123000.0, 5633400000.0], [\"E08000010\", \"Wigan\", 168000.0, 5124000000.0], [\"E08000011\", \"Knowsley\", 71000.0, 2051900000.0], [\"E08000012\", \"Liverpool\", 196000.0, 6154400000.0], [\"E08000013\", \"St. Helens\", 87000.0, 2679600000.0], [\"E08000014\", \"Sefton\", 137000.0, 4644300000.0], [\"E08000015\", \"Wirral\", 151000.0, 5028300000.0], [\"E08000016\", \"Barnsley\", 121000.0, 3642100000.0], [\"E08000017\", \"Doncaster\", 143000.0, 4361500000.0], [\"E08000018\", \"Rotherham\", 123000.0, 3776100000.0], [\"E08000019\", \"Sheffield\", 233000.0, 7595800000.0], [\"E08000021\", \"Newcastle upon Tyne\", 118000.0, 4177200000.0], [\"E08000022\", \"North Tyneside\", 104000.0, 3390400000.0], [\"E08000023\", \"South Tyneside\", 66000.0, 2026200000.0], [\"E08000024\", \"Sunderland\", 125000.0, 3587500000.0], [\"E08000025\", \"Birmingham\", 417000.0, 13427400000.0], [\"E08000026\", \"Coventry\", 152000.0, 4636000000.0], [\"E08000027\", \"Dudley\", 147000.0, 4365900000.0], [\"E08000028\", \"Sandwell\", 134000.0, 3725200000.0], [\"E08000029\", \"Solihull\", 115000.0, 4692000000.0], [\"E08000030\", \"Walsall\", 117000.0, 3521700000.0], [\"E08000031\", \"Wolverhampton\", 120000.0, 3504000000.0], [\"E08000032\", \"Bradford\", 202000.0, 6342800000.0], [\"E08000033\", \"Calderdale\", 97000.0, 3094300000.0], [\"E08000034\", \"Kirklees\", 198000.0, 6375600000.0], [\"E08000035\", \"Leeds\", 381000.0, 13373100000.0], [\"E08000036\", \"Wakefield\", 179000.0, 5549000000.0], [\"E08000037\", \"Gateshead\", 95000.0, 2907000000.0], [\"E09000001\", \"City of London\", 9000.0, 1503000000.0], [\"E09000002\", \"Barking and Dagenham\", 90000.0, 2862000000.0], [\"E09000003\", \"Barnet\", 190000.0, 11229000000.0], [\"E09000004\", \"Bexley\", 135000.0, 5130000000.0], [\"E09000005\", \"Brent\", 149000.0, 6570900000.0], [\"E09000006\", \"Bromley\", 176000.0, 9592000000.0], [\"E09000007\", \"Camden\", 108000.0, 12852000000.0], [\"E09000008\", \"Croydon\", 192000.0, 7852800000.0], [\"E09000009\", \"Ealing\", 178000.0, 8330400000.0], [\"E09000010\", \"Enfield\", 142000.0, 6077600000.0], [\"E09000011\", \"Greenwich\", 136000.0, 6650400000.0], [\"E09000012\", \"Hackney\", 123000.0, 6457500000.0], [\"E09000013\", \"Hammersmith and Fulham\", 98000.0, 8192800000.0], [\"E09000014\", \"Haringey\", 128000.0, 7308800000.0], [\"E09000015\", \"Harrow\", 125000.0, 5812500000.0], [\"E09000016\", \"Havering\", 135000.0, 5400000000.0], [\"E09000017\", \"Hillingdon\", 144000.0, 5990400000.0], [\"E09000018\", \"Hounslow\", 140000.0, 6356000000.0], [\"E09000019\", \"Islington\", 110000.0, 8426000000.0], [\"E09000020\", \"Kensington and Chelsea\", 68000.0, 14144000000.0], [\"E09000021\", \"Kingston upon Thames\", 82000.0, 4633000000.0], [\"E09000022\", \"Lambeth\", 169000.0, 9480900000.0], [\"E09000023\", \"Lewisham\", 149000.0, 6675200000.0], [\"E09000024\", \"Merton\", 114000.0, 7182000000.0], [\"E09000025\", \"Newham\", 146000.0, 5270600000.0], [\"E09000026\", \"Redbridge\", 138000.0, 5892600000.0], [\"E09000027\", \"Richmond upon Thames\", 104000.0, 9401600000.0], [\"E09000028\", \"Southwark\", 156000.0, 9016800000.0], [\"E09000029\", \"Sutton\", 102000.0, 4610400000.0], [\"E09000030\", \"Tower Hamlets\", 147000.0, 8158500000.0], [\"E09000031\", \"Waltham Forest\", 140000.0, 5614000000.0], [\"E09000032\", \"Wandsworth\", 182000.0, 14505400000.0], [\"E09000033\", \"Westminster\", 102000.0, 13566000000.0], [\"N09000001\", \"Antrim and Newtownabbey\", 65000.0, 2086500000.0], [\"N09000002\", \"Armagh City, Banbridge and Craigavon\", 98000.0, 3018400000.0], [\"N09000003\", \"Belfast\", 143000.0, 4776200000.0], [\"N09000004\", \"Causeway Coast and Glens\", 56000.0, 1775200000.0], [\"N09000005\", \"Derry City and Strabane\", 60000.0, 1854000000.0], [\"N09000006\", \"Fermanagh and Omagh\", 44000.0, 1355200000.0], [\"N09000007\", \"Lisburn and Castlereagh\", 72000.0, 2570400000.0], [\"N09000008\", \"Mid and East Antrim\", 63000.0, 1978200000.0], [\"N09000009\", \"Mid Ulster\", 64000.0, 2041600000.0], [\"N09000010\", \"Newry, Mourne and Down\", 70000.0, 2233000000.0], [\"S12000005\", \"Clackmannanshire\", 25000.0, 822500000.0], [\"S12000006\", \"Dumfries and Galloway\", 73000.0, 2182700000.0], [\"S12000008\", \"East Ayrshire\", 61000.0, 1891000000.0], [\"S12000010\", \"East Lothian\", 56000.0, 2312800000.0], [\"S12000011\", \"East Renfrewshire\", 51000.0, 2136900000.0], [\"S12000013\", \"Na h-Eileanan Siar\", 13000.0, 400400000.0], [\"S12000014\", \"Falkirk\", 85000.0, 2762500000.0], [\"S12000017\", \"Highland\", 121000.0, 3944600000.0], [\"S12000018\", \"Inverclyde\", 38000.0, 1197000000.0], [\"S12000019\", \"Midlothian\", 53000.0, 1796700000.0], [\"S12000020\", \"Moray\", 46000.0, 1518000000.0], [\"S12000021\", \"North Ayrshire\", 61000.0, 1884900000.0], [\"S12000023\", \"Orkney Islands\", 11000.0, 366300000.0], [\"S12000026\", \"Scottish Borders\", 58000.0, 1972000000.0], [\"S12000027\", \"Shetland Islands\", 11000.0, 418000000.0], [\"S12000028\", \"South Ayrshire\", 54000.0, 1900800000.0], [\"S12000029\", \"South Lanarkshire\", 162000.0, 5572800000.0], [\"S12000030\", \"Stirling\", 48000.0, 1915200000.0], [\"S12000033\", \"Aberdeen City\", 108000.0, 4233600000.0], [\"S12000034\", \"Aberdeenshire\", 137000.0, 5438900000.0], [\"S12000035\", \"Argyll and Bute\", 43000.0, 1500700000.0], [\"S12000036\", \"Edinburgh, City of\", 267000.0, 11988300000.0], [\"S12000038\", \"Renfrewshire\", 95000.0, 3040000000.0], [\"S12000039\", \"West Dunbartonshire\", 46000.0, 1361600000.0], [\"S12000040\", \"West Lothian\", 96000.0, 3216000000.0], [\"S12000041\", \"Angus\", 60000.0, 1950000000.0], [\"S12000042\", \"Dundee City\", 60000.0, 1812000000.0], [\"S12000045\", \"East Dunbartonshire\", 63000.0, 2457000000.0], [\"S12000047\", \"Fife\", 177000.0, 5734800000.0], [\"S12000048\", \"Perth and Kinross\", 85000.0, 2966500000.0], [\"S12000049\", \"Glasgow City\", 270000.0, 8748000000.0], [\"S12000050\", \"North Lanarkshire\", 159000.0, 5008500000.0], [\"W06000001\", \"Isle of Anglesey\", 35000.0, 1015000000.0], [\"W06000002\", \"Gwynedd\", 51000.0, 1555500000.0], [\"W06000003\", \"Conwy\", 54000.0, 1706400000.0], [\"W06000004\", \"Denbighshire\", 44000.0, 1368400000.0], [\"W06000005\", \"Flintshire\", 81000.0, 2592000000.0], [\"W06000006\", \"Wrexham\", 68000.0, 2067200000.0], [\"W06000008\", \"Ceredigion\", 33000.0, 953700000.0], [\"W06000009\", \"Pembrokeshire\", 58000.0, 1769000000.0], [\"W06000010\", \"Carmarthenshire\", 91000.0, 2793700000.0], [\"W06000011\", \"Swansea\", 113000.0, 3604700000.0], [\"W06000012\", \"Neath Port Talbot\", 69000.0, 2007900000.0], [\"W06000013\", \"Bridgend\", 68000.0, 2142000000.0], [\"W06000014\", \"The Vale of Glamorgan\", 65000.0, 2385500000.0], [\"W06000015\", \"Cardiff\", 162000.0, 5864400000.0], [\"W06000016\", \"Rhondda, Cynon, Taff\", 116000.0, 3375600000.0], [\"W06000018\", \"Caerphilly\", 79000.0, 2354200000.0], [\"W06000019\", \"Blaenau Gwent\", 31000.0, 827700000.0], [\"W06000020\", \"Torfaen\", 43000.0, 1238400000.0], [\"W06000021\", \"Monmouthshire\", 51000.0, 1953300000.0], [\"W06000022\", \"Newport\", 72000.0, 2253600000.0], [\"W06000023\", \"Powys\", 65000.0, 1995500000.0], [\"W06000024\", \"Merthyr Tydfil\", 25000.0, 710000000.0]];\n\n        // Define the dt_args\n        let dt_args = {\"layout\": {\"topStart\": \"pageLength\", \"topEnd\": \"search\", \"bottomStart\": \"info\", \"bottomEnd\": \"paging\"}, \"order\": [], \"warn_on_selected_rows_not_rendered\": true};\n        dt_args[\"data\"] = data;\n\n        \n        new DataTable(table, dt_args);\n    });\n</script>\n","content_type":"text/html"},"text/plain":{"content":"          code                     name  total_income_count  \\\n0    E06000001            Hartlepool UA             41000.0   \n1    E06000002         Middlesbrough UA             60000.0   \n2    E06000003  Redcar and Cleveland UA             65000.0   \n3    E06000004      Stockton-on-Tees UA             91000.0   \n4    E06000005            Darlington UA             52000.0   \n..         ...                      ...                 ...   \n355  W06000020                  Torfaen             43000.0   \n356  W06000021            Monmouthshire             51000.0   \n357  W06000022                  Newport             72000.0   \n358  W06000023                    Powys             65000.0   \n359  W06000024           Merthyr Tydfil             25000.0   \n\n     total_income_amount  \n0           1.258700e+09  \n1           1.812000e+09  \n2           1.885000e+09  \n3           3.039400e+09  \n4           1.653600e+09  \n..                   ...  \n355         1.238400e+09  \n356         1.953300e+09  \n357         2.253600e+09  \n358         1.995500e+09  \n359         7.100000e+08  \n\n[360 rows x 4 columns]","content_type":"text/plain"}}}],"key":"g8TKmEHel4"}],"key":"A154gQoYG4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Population data by age","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ihny5vcRLm"}],"identifier":"population-data-by-age","label":"Population data by age","html_id":"population-data-by-age","implicit":true,"key":"JnxijaJzX2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Population data by age groups for UK local authorities can be downloaded from the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Rd87ujbiD3"},{"type":"link","url":"https://www.nomisweb.co.uk/datasets/pestsyoala","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ONS data dashboard","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gxXJ3mdM60"}],"urlSource":"https://www.nomisweb.co.uk/datasets/pestsyoala","key":"DJcKLDRRvO"},{"type":"text","value":". The dataset provides detailed age breakdowns for each UK local authority, containing population counts for every age from 0 to 90+ years old across all local authorities in England, Wales, Northern Ireland, and Scotland. The data is stored as ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nRfaGAzhvd"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/age.csv","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"age.csv","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TxR3K5GTRW"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/age.csv","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/age.csv","raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/age.csv"},"internal":false,"protocol":"github","key":"OHstwlquVy"},{"type":"text","value":". The following table shows the dataset:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pCqtzOzhPu"}],"key":"VclvganlN8"}],"key":"TBBEeyMxvt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nfrom itables import init_notebook_mode, show\nimport itables.options as opt\nopt.maxBytes = \"1MB\"\ninit_notebook_mode(all_interactive=True)\n\npd.read_csv(\"../policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/age.csv\")","key":"D4QyKcYFqN"},{"type":"output","id":"c10s8aoFS4RlCYP82c89v","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<script>\n    let is_dark_theme = function () {\n        // Jupyter Lab\n        if ('jpThemeLight' in document.body.dataset)\n            return (document.body.dataset.jpThemeLight === \"false\");\n\n        // VS Code\n        if ('vscodeThemeKind' in document.body.dataset)\n            return document.body.dataset.vscodeThemeKind.includes('dark');\n\n        // Jupyter Book\n        if ('theme' in document.documentElement.dataset)\n            return document.documentElement.dataset.theme.includes('dark');\n\n        // Default\n        return window.matchMedia('(prefers-color-scheme: dark)').matches;\n    }\n\n    if (is_dark_theme()) {\n        document.documentElement.classList.add('dark');\n    }\n    else {\n        document.documentElement.classList.remove('dark');\n    }\n</script>\n","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"c6ab3fbdab1ff94600e51c14dfe3f701","path":"/policyengine-uk-data/build/c6ab3fbdab1ff94600e51c14dfe3f701.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"82dda12d147feefde781ca70cdef6586","path":"/policyengine-uk-data/build/82dda12d147feefde781ca70cdef6586.html"},"text/plain":{"content":"          code                  name       all       0       1       2  \\\n0    E06000001            Hartlepool   95366.0   915.0   960.0   981.0   \n1    E06000002         Middlesbrough  152650.0  1824.0  1798.0  1766.0   \n2    E06000003  Redcar and Cleveland  137938.0  1259.0  1359.0  1226.0   \n3    E06000004      Stockton-on-Tees  202415.0  1924.0  2078.0  2032.0   \n4    E06000005            Darlington  110562.0  1010.0  1115.0  1102.0   \n..         ...                   ...       ...     ...     ...     ...   \n355  W06000020               Torfaen   93419.0   928.0   975.0   934.0   \n356  W06000021         Monmouthshire   94572.0   738.0   796.0   830.0   \n357  W06000022               Newport  163628.0  1835.0  1984.0  1934.0   \n358  W06000023                 Powys  134439.0   952.0  1094.0  1083.0   \n359  W06000024        Merthyr Tydfil   58593.0   573.0   607.0   616.0   \n\n          3       4       5       6  ...      81     82     83     84     85  \\\n0    1066.0  1081.0  1069.0  1152.0  ...   500.0  442.0  465.0  407.0  429.0   \n1    1830.0  1889.0  1940.0  2081.0  ...   722.0  580.0  574.0  557.0  520.0   \n2    1367.0  1416.0  1419.0  1535.0  ...   992.0  851.0  854.0  828.0  685.0   \n3    2203.0  2266.0  2282.0  2451.0  ...  1133.0  993.0  941.0  885.0  819.0   \n4    1157.0  1168.0  1210.0  1152.0  ...   633.0  592.0  613.0  554.0  503.0   \n..      ...     ...     ...     ...  ...     ...    ...    ...    ...    ...   \n355  1027.0  1037.0  1048.0  1061.0  ...   611.0  545.0  461.0  451.0  412.0   \n356   828.0   828.0   878.0   917.0  ...   807.0  657.0  666.0  571.0  524.0   \n357  2011.0  2095.0  2054.0  2104.0  ...   858.0  734.0  689.0  658.0  554.0   \n358  1138.0  1206.0  1261.0  1264.0  ...  1164.0  979.0  982.0  878.0  808.0   \n359   649.0   679.0   685.0   738.0  ...   323.0  265.0  268.0  227.0  235.0   \n\n        86     87     88     89     90+  \n0    382.0  266.0  300.0  206.0   828.0  \n1    457.0  424.0  341.0  301.0  1120.0  \n2    637.0  546.0  456.0  370.0  1314.0  \n3    693.0  568.0  535.0  390.0  1570.0  \n4    448.0  377.0  354.0  277.0  1083.0  \n..     ...    ...    ...    ...     ...  \n355  341.0  349.0  285.0  252.0   813.0  \n356  477.0  442.0  379.0  322.0  1287.0  \n357  536.0  472.0  364.0  321.0  1282.0  \n358  735.0  616.0  530.0  455.0  1761.0  \n359  199.0  158.0  147.0  114.0   412.0  \n\n[360 rows x 94 columns]","content_type":"text/plain"}}}],"key":"Z507FkPCvb"}],"key":"bHep7nCEhs"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Preprocessing","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zhFTxFt1ap"}],"identifier":"preprocessing","label":"Preprocessing","html_id":"preprocessing","implicit":true,"key":"d44guuCvEz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this section, we detail a preprocessing step necessary for our local authority level analysis: converting earnings percentiles into practical income brackets.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CzRqJRrCsb"}],"key":"MhKGZgBBdW"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Convert earning percentiles to brackets","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yCK5fmOTZa"}],"identifier":"convert-earning-percentiles-to-brackets","label":"Convert earning percentiles to brackets","html_id":"convert-earning-percentiles-to-brackets","implicit":true,"key":"u4avk63OnE"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To analyze earnings data effectively, we convert earning percentiles into earning brackets through the following process:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Rm8h60kBky"}],"key":"AbemNoxUwC"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"First, we estimate the full distribution of earnings by:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"X93GG7xbRl"}],"key":"qDCMSaaMYK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Using known percentile data (10th to 90th) from the ASHE dataset","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"foSrpmIPdP"}],"key":"YqRCVCkcxO"}],"key":"mUZAPAfMHF"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Extending this to estimate the 90th-99th percentiles using ratios derived from ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"wCePwdh5sE"},{"type":"link","url":"https://www.gov.uk/government/statistics/percentile-points-from-1-to-99-for-total-income-before-and-after-tax#:~:text=Details,in%20the%20Background%20Quality%20Report","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"this government statistics report","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"DXui61xUfs"}],"urlSource":"https://www.gov.uk/government/statistics/percentile-points-from-1-to-99-for-total-income-before-and-after-tax#:~:text=Details,in%20the%20Background%20Quality%20Report","key":"paYN9eUmyX"}],"key":"DkCFDhtlwF"}],"key":"nnETGrwG95"}],"key":"H1f05jkHEt"}],"key":"Gy4s75eZ7k"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"This estimation allows us to map earnings data into brackets that align with policy thresholds.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"gmBHGxzSrE"}],"key":"o0fRjjSDlY"}],"key":"Vljdw0etEZ"}],"key":"oKXx7me9rt"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"After estimating the full earnings distribution, we convert the data into income brackets. We calculate the number of jobs and total earnings for each local authority and income bracket based on the estimated earnings distribution. When we encounter local authorities with missing data, we estimate their earnings distribution pattern using data from local authorities with similar total number of taxpayers and total income levels.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"xq7F9b4yKT"}],"key":"fjXDf43tHn"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"The script ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"QlZxnHVlsc"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/create_employment_incomes.py","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineCode","value":"create_employment_incomes.py","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"YIQn4lilDN"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/create_employment_incomes.py","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/create_employment_incomes.py","raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/create_employment_incomes.py"},"internal":false,"protocol":"github","key":"C9PcetsBoV"},{"type":"text","value":" generates ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ofsWBgXLib"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineCode","value":"employment_income.csv","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"AJNLD6GdG7"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv","raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv"},"internal":false,"protocol":"github","key":"AxQ4NBcm47"},{"type":"text","value":" containing number of jobs (","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"HHm4Z5PA13"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv#L1","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineCode","value":"employment_income_count","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"I3yRc2v1L7"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv#L1","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv","from":1,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv"},"internal":false,"protocol":"github","key":"kEO7jCno9g"},{"type":"text","value":") and total earnings (","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"HNoNQTth9O"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv#L1","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineCode","value":"employment_income_amount","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"mdJeNVgsZe"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv#L1","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv","from":1,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv"},"internal":false,"protocol":"github","key":"zDarSC0VHi"},{"type":"text","value":") for each local authority and income bracket. The following table shows employment and income across different brackets for local authorities:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ouPDxmPrtk"}],"key":"turrws8Qqb"}],"key":"oXgMfi9kbU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nfrom itables import init_notebook_mode, show\nimport itables.options as opt\nopt.maxBytes = \"1MB\"\ninit_notebook_mode(all_interactive=True)\n\npd.read_csv(\"../policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv\")","key":"d9mOuGUzUD"},{"type":"output","id":"cNvDDHG397nM5gNckHTfz","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<script>\n    let is_dark_theme = function () {\n        // Jupyter Lab\n        if ('jpThemeLight' in document.body.dataset)\n            return (document.body.dataset.jpThemeLight === \"false\");\n\n        // VS Code\n        if ('vscodeThemeKind' in document.body.dataset)\n            return document.body.dataset.vscodeThemeKind.includes('dark');\n\n        // Jupyter Book\n        if ('theme' in document.documentElement.dataset)\n            return document.documentElement.dataset.theme.includes('dark');\n\n        // Default\n        return window.matchMedia('(prefers-color-scheme: dark)').matches;\n    }\n\n    if (is_dark_theme()) {\n        document.documentElement.classList.add('dark');\n    }\n    else {\n        document.documentElement.classList.remove('dark');\n    }\n</script>\n","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"c6ab3fbdab1ff94600e51c14dfe3f701","path":"/policyengine-uk-data/build/c6ab3fbdab1ff94600e51c14dfe3f701.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"074a8be9f684bbbd36b85bb6b14e0cc0","path":"/policyengine-uk-data/build/074a8be9f684bbbd36b85bb6b14e0cc0.html"},"text/plain":{"content":"           code            name  employment_income_lower_bound  \\\n0     E06000001      Hartlepool                              0   \n1     E06000001      Hartlepool                          50000   \n2     E06000001      Hartlepool                          12570   \n3     E06000001      Hartlepool                          15000   \n4     E06000001      Hartlepool                          30000   \n...         ...             ...                            ...   \n4675  W06000024  Merthyr Tydfil                         200000   \n4676  W06000024  Merthyr Tydfil                         300000   \n4677  W06000024  Merthyr Tydfil                          50000   \n4678  W06000024  Merthyr Tydfil                          20000   \n4679  W06000024  Merthyr Tydfil                         500000   \n\n      employment_income_upper_bound  employment_income_count  \\\n0                           12570.0               758.154411   \n1                           70000.0              4042.906639   \n2                           15000.0               405.049313   \n3                           20000.0              1609.951463   \n4                           40000.0              5209.259896   \n...                             ...                      ...   \n4675                       300000.0                74.985344   \n4676                       500000.0                 0.000000   \n4677                        70000.0              4111.661887   \n4678                        30000.0              5329.828771   \n4679                            inf                 0.000000   \n\n      employment_income_amount  \n0                 4.765000e+06  \n1                 2.425744e+08  \n2                 5.583605e+06  \n3                 2.817415e+07  \n4                 1.823241e+08  \n...                        ...  \n4675              1.874634e+07  \n4676              0.000000e+00  \n4677              2.466997e+08  \n4678              1.332457e+08  \n4679              0.000000e+00  \n\n[4680 rows x 6 columns]","content_type":"text/plain"}}}],"key":"wjBK0tcbmf"}],"key":"ZsUJGhOCcR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Methodology","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GjE0Yy8QTg"}],"identifier":"methodology","label":"Methodology","html_id":"methodology","implicit":true,"key":"gegcFegwx6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This section describes our approach to creating accurate local authority level estimates through three key components: a loss function for evaluating accuracy, a calibration process for optimizing weights, and the mathematical framework behind the optimization. To see how well this methodology performs in practice, you can check our detailed ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dMuEZ8hElL"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/docs/validation/local_authorities.ipynb","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"validation results page","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Agmpj4k3Vk"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/docs/validation/local_authorities.ipynb","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"docs/validation/local_authorities.ipynb","raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/docs/validation/local_authorities.ipynb"},"internal":false,"protocol":"github","key":"M796iXm0da"},{"type":"text","value":" comparing our estimates against actual data at both local authority and national levels.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xxyKCDctEj"}],"key":"oJUOa8vo16"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Loss function","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZRnLCHsNtj"}],"identifier":"loss-function","label":"Loss function","html_id":"loss-function","implicit":true,"key":"C12VZLyYT7"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The file ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DKk81zbAHl"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineCode","value":"loss.py","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Nsvct4YoC3"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py","raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py"},"internal":false,"protocol":"github","key":"Qc0TdnM2zt"},{"type":"text","value":" defines a function ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VTwiQIt6WP"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py#L8","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineCode","value":"create_local_authority_target_matrix","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PVg25Eznd4"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py#L8","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py","from":8,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py"},"internal":false,"protocol":"github","key":"zF0boxDDxA"},{"type":"text","value":" that creates target matrices for comparing simulated data against actual local authority level data. The following process outlines how the function processes:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qqSxLUubD3"}],"key":"rNI78RkNSu"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Takes three main input parameters: dataset (defaults to ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"vdjNTCxsGB"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py#L15","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"inlineCode","value":"enhanced_frs_2022_23","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"XF9vE7F4Yi"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py#L15","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py","from":15,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py"},"internal":false,"protocol":"github","key":"iZt2ybxfmw"},{"type":"text","value":"), time_period (defaults to 2025), and an optional reform parameter for policy changes.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"B9zkarP8F1"}],"key":"lezKtc3tap"}],"key":"Hl8DbIGw5c"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Reads three files containing real data: ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"PfCDtjErVu"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/age.csv","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"inlineCode","value":"age.csv","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ZPGpB8MJFa"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/age.csv","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/age.csv","raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/age.csv"},"internal":false,"protocol":"github","key":"QuxjJOX8Cq"},{"type":"text","value":", ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"DXEGSVKehD"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"inlineCode","value":"total_income.csv","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MQMToFFTL5"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv","raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/total_income.csv"},"internal":false,"protocol":"github","key":"SMguX41CGk"},{"type":"text","value":", and ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"bwckhZYRgM"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"inlineCode","value":"employment_income.csv","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"oASrchkWOm"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv","raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/targets/employment_income.csv"},"internal":false,"protocol":"github","key":"Rasj2sL5ey"},{"type":"text","value":".","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nvqG7rbRZP"}],"key":"wUFr6RUjjj"}],"key":"lp4TyYy37f"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Creates a PolicyEngine Microsimulation object using the specified dataset and reform parameters.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"vkv77uxVxH"}],"key":"zufSs8PHb6"}],"key":"mik2qlzHkK"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Creates two main matrices: ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"X73PA8SL6J"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py#L29","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"inlineCode","value":"matrix","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"LSRs6184zL"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py#L29","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py","from":29,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py"},"internal":false,"protocol":"github","key":"q6qqL2N1CY"},{"type":"text","value":" for simulated values from PolicyEngine, and ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"mq8LIlZ8vD"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py#L30","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"inlineCode","value":"y","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"kDJyz2Akr4"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py#L30","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py","from":30,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py"},"internal":false,"protocol":"github","key":"CsoD6NbdZz"},{"type":"text","value":" for actual target values from both HMRC (income data) and ONS (age data).","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"S93rmMDeRJ"}],"key":"B3lFNJEfos"}],"key":"ViF8tidnCx"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Calculates total income metrics at the national level, computing both total amounts and counts of people with income.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"n25DoxAptQ"}],"key":"ZkdZWeFZnN"}],"key":"TQDTHM3Y6h"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Processes age distributions by creating 10-year age bands from 0 to 80, calculating how many people fall into each band.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"DeuEcAgHcS"}],"key":"n64vNTz5bp"}],"key":"cjcPH96sEb"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Processes both counts and amounts for different income bands between 12,570 and 70,000, excluding people under 16 for employment income.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"orDGQ4Iow8"}],"key":"uhWiKN8WbH"}],"key":"Gg2Rid78ti"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Maps individual-level results to household level throughout the ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"T7k6FHLXIE"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py#L33","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"inlineCode","value":"sim.map_result()","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"Tp6RYaVzl0"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py#L33","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py","from":33,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py"},"internal":false,"protocol":"github","key":"DPyaUDl4nH"},{"type":"text","value":" function.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"hs2gSDGREZ"}],"key":"IrrTS9YMg4"}],"key":"uKM9h2xNdo"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"The function returns both the simulated matrix and the target matrix ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"PQQbG3pm6f"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py#L33","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"inlineCode","value":"(matrix, y)","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"c4aGCg7f0N"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py#L33","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py","from":33,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py"},"internal":false,"protocol":"github","key":"jbqUl2dupO"},{"type":"text","value":" which can be used for comparing the simulation results against actual data.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"Iv9uYk4H5n"}],"key":"IQfcCd9FT5"}],"key":"Azsc0Kyqqg"}],"key":"hTKnftjxOI"}],"key":"NE8a4zJlyO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Calibration function","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MLjsN2YVjW"}],"identifier":"calibration-function","label":"Calibration function","html_id":"calibration-function","implicit":true,"key":"XI51exe2nf"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The file ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wGioRJwxs4"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"calibrate.py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"b2rswIyhwD"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py","raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py"},"internal":false,"protocol":"github","key":"KQRDSvBqEL"},{"type":"text","value":" defines a main ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"C0EpEcbXgh"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py#L16","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"calibrate()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KSAuucIbOe"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py#L16","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py","from":16,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py"},"internal":false,"protocol":"github","key":"qTbtuJTF9S"},{"type":"text","value":" function that performs weight calibration for local authority level analysis.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"g9XdbtmC1E"}],"key":"oF2lEYLNtY"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"It imports necessary functions and matrices from other files including ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iLomhVZYXh"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py#L17","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"create_local_authority_target_matrix","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"blwkUt9ZcR"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py#L17","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py","from":17,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py"},"internal":false,"protocol":"github","key":"jlLF5bMh1y"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zD9R5JcijJ"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py#L21","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"create_national_target_matrix","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"c3h5oRWjAL"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py#L21","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py","from":21,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py"},"internal":false,"protocol":"github","key":"FxiYopO3Fr"},{"type":"text","value":" from ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"a1AlpybeGH"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"loss.py","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZokIGK59Ex"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py","raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/loss.py"},"internal":false,"protocol":"github","key":"Pya5iiqUXs"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LJ3ofy4xW7"}],"key":"rRy75jzLQT"}],"key":"c67pYV6blw"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Sets up initial matrices using the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"dRjM0yUOd2"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py#L17","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineCode","value":"create_local_authority_target_matrix","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VStvdLnFlY"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py#L17","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py","from":17,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py"},"internal":false,"protocol":"github","key":"GGVCTFE7d8"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MuFWd7gHa1"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py#L21","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineCode","value":"create_national_target_matrix","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kkSBqGsnX1"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py#L21","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py","from":21,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py"},"internal":false,"protocol":"github","key":"cZY2uWfJDI"},{"type":"text","value":" functions for both local authority and national level data.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"khpWoaur6J"}],"key":"YFUw5Akmrm"}],"key":"UWJxv7v7j8"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Creates a Microsimulation object using the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"egFx5hhrLs"},{"type":"link","url":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py#L25","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"inlineCode","value":"enhanced_frs_2022_23","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BzoVCNo9p4"}],"urlSource":"https://github.com/PolicyEngine/policyengine-uk-data/blob/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py#L25","data":{"kind":"file","org":"PolicyEngine","repo":"policyengine-uk-data","reference":"7c782c4839a024c729350a3ff2c76922bf21b0d4","file":"policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py","from":25,"raw":"https://raw.githubusercontent.com/PolicyEngine/policyengine-uk-data/7c782c4839a024c729350a3ff2c76922bf21b0d4/policyengine_uk_data/datasets/frs/local_areas/local_authorities/calibrate.py"},"internal":false,"protocol":"github","key":"hk71S45zu0"},{"type":"text","value":" dataset.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"HHlh3sT2D4"}],"key":"INr43Ex3RV"}],"key":"RwwP0eDceA"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Initializes weights for 360 local authority districts x 100180 households, starting with the log of household weights divided by local authority district count.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"YEZxInImsr"}],"key":"ia2o8eNmKA"}],"key":"AraCYbD29u"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Converts all the matrices and weights into PyTorch tensors to enable optimization.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"MpmKjAEvgy"}],"key":"SZiUgxcFD3"}],"key":"iWZ2PXDX5x"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Defines a loss function that calculates and combines both local authority level and national-level mean squared errors into a single loss value.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"JtqpAGIRc9"}],"key":"dn6cvEvtYS"}],"key":"iwdRKDYl7g"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Uses Adam optimizer with a learning rate of 0.1 to minimize the loss over 512 epochs.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"PzEYb5spqQ"}],"key":"r536wwVgL9"}],"key":"x6hxVtIssj"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Every 100 epochs during optimization, it updates the weights and saves the current weights to a ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"iHxYEdcY1u"},{"type":"inlineCode","value":"weights.h5","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"IOd73Rwaaf"},{"type":"text","value":" file.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"zOJIogu78F"}],"key":"wsus3mjggR"}],"key":"cLBOkloDtf"}],"key":"JWrJprU7Bk"}],"key":"JhyISe3L4D"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Optimization mathematics","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wbGg8cYPTt"}],"identifier":"optimization-mathematics","label":"Optimization mathematics","html_id":"optimization-mathematics","implicit":true,"key":"PUbqpMW0Sg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this part, we explain the mathematics behind the calibration process that we discussed above. The optimization uses a two-part loss function that balances local authority level and national-level accuracy, combining both local and national targets into a single optimization problem. The mathematical formulation can be expressed as follows:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bXYiXwkJNC"}],"key":"tmHzSWsaXt"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For the local authority level component, we have:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AqoSqOkQyJ"}],"key":"cywDHSuBEJ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A set of households (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"xMwr7Ki8oy"},{"type":"inlineMath","value":"j","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"Oayanh9KtD"},{"type":"text","value":") with known characteristics (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"I6BE0ZWNMY"},{"type":"inlineMath","value":"metrics_j","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>e</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>c</mi><msub><mi>s</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">metrics_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9456em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">c</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ujXcN3FqZ4"},{"type":"text","value":") like income, age, etc.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"kipDz9P05s"}],"key":"IK6Sf2yh38"}],"key":"JLDIjliBwb"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A set of local authorities (","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ixpHIQadNR"},{"type":"inlineMath","value":"i","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"UlLxpgWWyC"},{"type":"text","value":") with known target values (","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"y4SKxQI99I"},{"type":"inlineMath","value":"y_c","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"RtD6sxJVlK"},{"type":"text","value":") from official statistics","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"sAxfu2NQ9K"}],"key":"g75TyO5YCY"}],"key":"t2cflfRJ2J"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Weights in log space (","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"LMLBXaTJKg"},{"type":"inlineMath","value":"w_{ij}","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">w_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"jSpqONoDEZ"},{"type":"text","value":") that we need to optimize for each household in each local authority","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"zjQybDz1ju"}],"key":"avR6RxvrLY"}],"key":"PMJsRcy2aP"}],"key":"Mygz1nFX7q"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Using these components, we calculate predicted local authority level statistics. For each local authority metric (e.g. total income), the predicted value is:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"nnRBMGXYxQ"}],"key":"kygxD14hwV"},{"type":"math","value":"\\text{pred}_c = \\sum_j (\\exp(w_{ij}) \\times \\text{metrics}_j)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mtext>pred</mtext><mi>c</mi></msub><mo>=</mo><munder><mo></mo><mi>j</mi></munder><mo stretchy=\"false\">(</mo><mi>exp</mi><mo></mo><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo></mo><msub><mtext>metrics</mtext><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{pred}_c = \\sum_j (\\exp(w_{ij}) \\times \\text{metrics}_j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9386em;vertical-align:-0.2441em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">pred</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0573em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4638em;vertical-align:-1.4138em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\"></span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">metrics</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"1","key":"tOVTkI58nB"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"OmBRdk2bga"},{"type":"inlineMath","value":"\\text{metrics}_j","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mtext>metrics</mtext><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\text{metrics}_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.954em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">metrics</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"c9ogh0B4XD"},{"type":"text","value":" represents the household-level characteristics for that specific metric (e.g. household income). We use exponential of weights to ensure they stay positive.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"r8vDs5l8st"}],"key":"Gm7B1GanS0"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"To measure how well our predictions match the real local authority data, we calculate the local authority mean squared error:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"KvTHByiyiy"}],"key":"LMEbCcGYwg"},{"type":"math","value":"\\text{MSE}_c = \\text{mean}((\\text{pred}_c / (1 + y_c) - 1)^2)","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mtext>MSE</mtext><mi>c</mi></msub><mo>=</mo><mtext>mean</mtext><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">(</mo><msub><mtext>pred</mtext><mi>c</mi></msub><mi mathvariant=\"normal\">/</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo>+</mo><msub><mi>y</mi><mi>c</mi></msub><mo stretchy=\"false\">)</mo><mo></mo><mn>1</mn><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{MSE}_c = \\text{mean}((\\text{pred}_c / (1 + y_c) - 1)^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">MSE</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">mean</span></span><span class=\"mopen\">((</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">pred</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0573em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"2","key":"UjFo56NQ5v"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"kGMHPQz51A"},{"type":"inlineMath","value":"y_c","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PXgnhtecT0"},{"type":"text","value":" are the actual target values from official statistics for each local authority. We use relative error (dividing by ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"PJ98xJw7pK"},{"type":"inlineMath","value":"1 + y_c","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>+</mo><msub><mi>y</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">1 + y_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"sluJSOYYzj"},{"type":"text","value":") to make errors comparable across different scales of metrics.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"CVzDn16j4e"}],"key":"HnvPV41bCo"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"For the national component, we need to ensure our local authority level adjustments dont distort national-level statistics. We aggregate across all local authorities:","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"rM8ftobhmm"}],"key":"CBNnOOsIX7"},{"type":"math","value":"\\text{pred}_n = \\sum_i (\\sum_j \\exp(w_{ij})) \\times \\text{metrics}_\\text{national}","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mtext>pred</mtext><mi>n</mi></msub><mo>=</mo><munder><mo></mo><mi>i</mi></munder><mo stretchy=\"false\">(</mo><munder><mo></mo><mi>j</mi></munder><mi>exp</mi><mo></mo><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo></mo><msub><mtext>metrics</mtext><mtext>national</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\text{pred}_n = \\sum_i (\\sum_j \\exp(w_{ij})) \\times \\text{metrics}_\\text{national}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9386em;vertical-align:-0.2441em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">pred</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0573em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4638em;vertical-align:-1.4138em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\"></span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\"></span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8179em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">metrics</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">national</span></span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"3","key":"zAXOdZRuzG"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"with corresponding mean squared error to measure deviation from national targets:","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"FPhfHEVxd2"}],"key":"qxyOXyigwY"},{"type":"math","value":"\\text{MSE}_n = \\text{mean}((\\text{pred}_n / (1 + y_n) - 1)^2)","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mtext>MSE</mtext><mi>n</mi></msub><mo>=</mo><mtext>mean</mtext><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">(</mo><msub><mtext>pred</mtext><mi>n</mi></msub><mi mathvariant=\"normal\">/</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo>+</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo><mo></mo><mn>1</mn><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{MSE}_n = \\text{mean}((\\text{pred}_n / (1 + y_n) - 1)^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">MSE</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">mean</span></span><span class=\"mopen\">((</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">pred</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0573em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"4","key":"dFZ7mf7Dx0"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"The total loss combines both local authority and national errors:","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"FbiFFSE8bF"}],"key":"KfDBxk2TK1"},{"type":"math","value":"L = \\text{MSE}_c + \\text{MSE}_n","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>L</mi><mo>=</mo><msub><mtext>MSE</mtext><mi>c</mi></msub><mo>+</mo><msub><mtext>MSE</mtext><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">L = \\text{MSE}_c + \\text{MSE}_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">MSE</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">MSE</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"5","key":"WZ3vxKOdBB"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"We initialize the weights using the original household weights from the survey data:","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"Wf9TrMhuN1"}],"key":"F5fsfLWntm"},{"type":"math","value":"w_{\\text{initial}} = \\ln(\\text{household}_{weight}/650)","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>w</mi><mtext>initial</mtext></msub><mo>=</mo><mi>ln</mi><mo></mo><mo stretchy=\"false\">(</mo><msub><mtext>household</mtext><mrow><mi>w</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow></msub><mi mathvariant=\"normal\">/</mi><mn>650</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">w_{\\text{initial}} = \\ln(\\text{household}_{weight}/650)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">initial</span></span></span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">household</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal mtight\">h</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\">/650</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"6","key":"jfOKgMQE7t"},{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"where 650 is the number of local authorities. These weights are then iteratively optimized using the Adam (Adaptive Moment Estimation) optimizer with a learning rate of 0.1. The optimization process runs for 512 epochs, with the weights being updated in each iteration:","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"Wtd8xkc83E"}],"key":"wqZOIjm8SH"},{"type":"math","value":"w_{t+1} = w_t - 0.1 \\times \\nabla L(w_t)","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>w</mi><mi>t</mi></msub><mo></mo><mn>0.1</mn><mo></mo><mi mathvariant=\"normal\"></mi><mi>L</mi><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">w_{t+1} = w_t - 0.1 \\times \\nabla L(w_t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">0.1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\"></span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"7","key":"mewV4rqRiL"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"This formulation ensures that the optimized weights maintain both local local authority at the local authority level and global accuracy for national-level statistics. The Adam optimizer adaptively adjusts the weights to minimize both local authority level and national-level errors simultaneously, providing efficient convergence through adaptive learning rates and momentum. The resulting optimized weights allow us to accurately reweight household survey data to match both local authority level and national statistics to obtain accurate estimates of income distributions, demographics, and policy impacts for each parliamentary local authority while maintaining local authority with national totals.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"uLbPhIBWIe"}],"key":"fYFCRSZWK4"}],"key":"HbQhB4bGP2"}],"key":"NrK6KdeV8X"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Constituency methodology","url":"/constituency-methodology","group":"PolicyEngine UK data"}}},"domain":"http://localhost:3000"}